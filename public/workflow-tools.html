<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Workflow Tools - MuseFlow</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="/static/js/config.js?v=4.0.0"></script>
    <script src="/static/js/components/template-library.js?v=4.0.0"></script>
    <script src="/static/js/components/export-import.js?v=4.0.0"></script>
    <script src="/static/js/components/saved-searches.js?v=4.0.0"></script>
    <style>
        :root {
            --museum-purple: #8b5cf6;
            --museum-pink: #ec4899;
            --bg-dark: #0a0a0f;
            --bg-card: rgba(255, 255, 255, 0.05);
            --border: rgba(255, 255, 255, 0.1);
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #0a0a0f 0%, #1a0a2e 100%);
            color: #f5f5f7;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        .header {
            margin-bottom: 3rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .title {
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--museum-purple), var(--museum-pink));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .back-btn {
            padding: 0.75rem 1.5rem;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border);
            border-radius: 12px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            text-decoration: none;
        }
        
        .back-btn:hover {
            background: rgba(139, 92, 246, 0.2);
            transform: translateY(-2px);
        }
        
        .tool-page {
            display: none;
        }
        
        .tool-page.active {
            display: block;
        }
        
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
        }
        
        .card {
            background: var(--bg-card);
            border: 2px solid var(--border);
            border-radius: 20px;
            padding: 1.5rem;
            transition: all 0.3s;
            cursor: pointer;
        }
        
        .card:hover {
            background: rgba(255, 255, 255, 0.08);
            transform: translateY(-4px);
            box-shadow: 0 12px 40px rgba(139, 92, 246, 0.3);
        }
        
        .card-icon {
            font-size: 2.5rem;
            margin-bottom: 0.75rem;
        }
        
        .card-title {
            font-size: 1.125rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: white;
        }
        
        .card-desc {
            font-size: 0.875rem;
            color: rgba(255, 255, 255, 0.6);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="title" id="page-title">
                <i class="fas fa-tools"></i>
                <span id="title-text">Workflow Tools</span>
            </h1>
            <a href="/dashboard.html" class="back-btn">
                <i class="fas fa-arrow-left"></i>
                Back to Dashboard
            </a>
        </div>
        
        <!-- Home Page -->
        <div id="home-page" class="tool-page active">
            <div class="grid">
                <div class="card" onclick="loadTool('templates')">
                    <div class="card-icon">ğŸ¨</div>
                    <h2 class="card-title">í”„ë¡œì íŠ¸ í…œí”Œë¦¿</h2>
                    <p class="card-desc">ì‚¬ì „ êµ¬ì„±ëœ í…œí”Œë¦¿ìœ¼ë¡œ ë¹ ë¥´ê²Œ í”„ë¡œì íŠ¸ë¥¼ ì‹œì‘í•˜ì„¸ìš”.</p>
                </div>
                
                <div class="card" onclick="loadTool('filter')">
                    <div class="card-icon">ğŸ”</div>
                    <h2 class="card-title">ê³ ê¸‰ í•„í„°</h2>
                    <p class="card-desc">ë³µì¡í•œ ì¡°ê±´ìœ¼ë¡œ í”„ë¡œì íŠ¸ë¥¼ ê²€ìƒ‰í•˜ê³  í•„í„°ë§í•˜ì„¸ìš”.</p>
                </div>
                
                <div class="card" onclick="loadTool('searches')">
                    <div class="card-icon">ğŸ”–</div>
                    <h2 class="card-title">ì €ì¥ëœ ê²€ìƒ‰</h2>
                    <p class="card-desc">ìì£¼ ì‚¬ìš©í•˜ëŠ” ê²€ìƒ‰ ì¡°ê±´ì„ ì €ì¥í•˜ê³  1-í´ë¦­ìœ¼ë¡œ ë¶ˆëŸ¬ì˜¤ì„¸ìš”.</p>
                </div>
                
                <div class="card" onclick="loadTool('export')">
                    <div class="card-icon">ğŸ“¤</div>
                    <h2 class="card-title">ë‚´ë³´ë‚´ê¸° / ê°€ì ¸ì˜¤ê¸°</h2>
                    <p class="card-desc">í”„ë¡œì íŠ¸ ë°ì´í„°ë¥¼ JSON, CSV, Excel í˜•ì‹ìœ¼ë¡œ ê´€ë¦¬í•˜ì„¸ìš”.</p>
                </div>
                
                <div class="card" onclick="location.href='/canvas-v3.html'">
                    <div class="card-icon">ğŸ¨</div>
                    <h2 class="card-title">Canvas V3 ë…¸ë“œ ì—ë””í„°</h2>
                    <p class="card-desc">ì‹œê°ì  ë…¸ë“œ ê¸°ë°˜ ì›Œí¬í”Œë¡œìš° í¸ì§‘ê¸°.</p>
                </div>
                
                <div class="card" onclick="loadTool('batch')">
                    <div class="card-icon">ğŸ“‹</div>
                    <h2 class="card-title">ì¼ê´„ ì‘ì—…</h2>
                    <p class="card-desc">ì—¬ëŸ¬ í”„ë¡œì íŠ¸ë¥¼ í•œ ë²ˆì— ì²˜ë¦¬í•˜ì„¸ìš”.</p>
                </div>
            </div>
        </div>
        
        <!-- Templates Page -->
        <div id="templates-page" class="tool-page">
            <div class="grid">
                <!-- Exhibition -->
                <div class="card" onclick="createProjectFromTemplate('exhibition')" style="border-color: rgba(139, 92, 246, 0.3);">
                    <div class="card-icon">ğŸ¨</div>
                    <h3 class="card-title">ì „ì‹œ ê´€ë¦¬</h3>
                    <p class="card-desc">ì „ì‹œ ê¸°íš, ì„¤ì¹˜, ìš´ì˜ ë° í‰ê°€</p>
                </div>
                
                <!-- Education -->
                <div class="card" onclick="createProjectFromTemplate('education')" style="border-color: rgba(6, 182, 212, 0.3);">
                    <div class="card-icon">ğŸ“</div>
                    <h3 class="card-title">êµìœ¡ í”„ë¡œê·¸ë¨</h3>
                    <p class="card-desc">êµìœ¡ í”„ë¡œê·¸ë¨ ê°œë°œ ë° ì‹¤í–‰</p>
                </div>
                
                <!-- Archive -->
                <div class="card" onclick="createProjectFromTemplate('archive')" style="border-color: rgba(16, 185, 129, 0.3);">
                    <div class="card-icon">ğŸ“¦</div>
                    <h3 class="card-title">ìˆ˜ì§‘ & ë³´ì¡´</h3>
                    <p class="card-desc">ìœ ë¬¼ ìˆ˜ì§‘, ë“±ë¡ ë° ë³´ì¡´</p>
                </div>
                
                <!-- Publication -->
                <div class="card" onclick="createProjectFromTemplate('publication')" style="border-color: rgba(245, 158, 11, 0.3);">
                    <div class="card-icon">ğŸ“š</div>
                    <h3 class="card-title">ì¶œíŒ & ì½˜í…ì¸ </h3>
                    <p class="card-desc">ë„ë¡ ë° ì½˜í…ì¸  ì œì‘</p>
                </div>
                
                <!-- Research -->
                <div class="card" onclick="createProjectFromTemplate('research')" style="border-color: rgba(236, 72, 153, 0.3);">
                    <div class="card-icon">ğŸ”¬</div>
                    <h3 class="card-title">ì—°êµ¬ & ì¡°ì‚¬</h3>
                    <p class="card-desc">í•™ìˆ  ì—°êµ¬ ë° ì¡°ì‚¬</p>
                </div>
                
                <!-- Admin -->
                <div class="card" onclick="createProjectFromTemplate('admin')" style="border-color: rgba(99, 102, 241, 0.3);">
                    <div class="card-icon">ğŸ›ï¸</div>
                    <h3 class="card-title">í–‰ì • & ìš´ì˜</h3>
                    <p class="card-desc">ì˜ˆì‚°, ì¸ì‚¬ ë° ì‹œì„¤ ê´€ë¦¬</p>
                </div>
                
                <!-- Digital Archive -->
                <div class="card" onclick="createProjectFromTemplate('digital_archive')" style="border-color: rgba(20, 184, 166, 0.3);">
                    <div class="card-icon">ğŸ’¾</div>
                    <h3 class="card-title">ë””ì§€í„¸ ì•„ì¹´ì´ë¸Œ</h3>
                    <p class="card-desc">ì†Œì¥í’ˆ ë””ì§€í„¸í™” ë° DB êµ¬ì¶•</p>
                </div>
                
                <!-- Marketing -->
                <div class="card" onclick="createProjectFromTemplate('marketing')" style="border-color: rgba(244, 63, 94, 0.3);">
                    <div class="card-icon">ğŸ“¢</div>
                    <h3 class="card-title">ë§ˆì¼€íŒ… ìº í˜ì¸</h3>
                    <p class="card-desc">ì „ì‹œ/í”„ë¡œê·¸ë¨ í™ë³´ ë° ë§ˆì¼€íŒ…</p>
                </div>
                
                <!-- Conservation -->
                <div class="card" onclick="createProjectFromTemplate('conservation')" style="border-color: rgba(139, 92, 246, 0.3);">
                    <div class="card-icon">ğŸ§ª</div>
                    <h3 class="card-title">ë³´ì¡´ê³¼í•™</h3>
                    <p class="card-desc">ìœ ë¬¼ ë³´ì¡´ì²˜ë¦¬ ë° ê³¼í•™ì¡°ì‚¬</p>
                </div>
                
                <!-- Community -->
                <div class="card" onclick="createProjectFromTemplate('community')" style="border-color: rgba(6, 182, 212, 0.3);">
                    <div class="card-icon">ğŸ¤</div>
                    <h3 class="card-title">ì»¤ë®¤ë‹ˆí‹° í˜‘ë ¥</h3>
                    <p class="card-desc">ì§€ì—­ì‚¬íšŒ ì—°ê³„ í”„ë¡œê·¸ë¨</p>
                </div>
            </div>
        </div>
        
        <!-- Filter Page -->
        <div id="filter-page" class="tool-page">
            <div style="max-width: 800px; margin: 0 auto;">
                <div style="background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 20px; padding: 2rem;">
                    <h2 style="font-size: 1.5rem; font-weight: 600; margin-bottom: 1.5rem;">ğŸ” ê³ ê¸‰ í•„í„°</h2>
                    
                    <!-- Date Range -->
                    <div style="margin-bottom: 1.5rem;">
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 500;">ë‚ ì§œ ë²”ìœ„</label>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                            <input type="date" id="filter-start-date" style="background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.15); padding: 0.75rem; border-radius: 12px; color: white;">
                            <input type="date" id="filter-end-date" style="background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.15); padding: 0.75rem; border-radius: 12px; color: white;">
                        </div>
                    </div>
                    
                    <!-- Keyword -->
                    <div style="margin-bottom: 1.5rem;">
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 500;">í‚¤ì›Œë“œ</label>
                        <input type="text" id="filter-keyword" placeholder="í”„ë¡œì íŠ¸ ì œëª©, ì„¤ëª… ê²€ìƒ‰" style="width: 100%; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.15); padding: 0.75rem; border-radius: 12px; color: white;">
                    </div>
                    
                    <!-- Curator -->
                    <div style="margin-bottom: 1.5rem;">
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 500;">íë ˆì´í„°</label>
                        <input type="text" id="filter-curator" placeholder="ë‹´ë‹¹ì ì´ë¦„" style="width: 100%; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.15); padding: 0.75rem; border-radius: 12px; color: white;">
                    </div>
                    
                    <!-- Location -->
                    <div style="margin-bottom: 1.5rem;">
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 500;">ìœ„ì¹˜</label>
                        <input type="text" id="filter-location" placeholder="ì „ì‹œê´€, ì¥ì†Œ" style="width: 100%; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.15); padding: 0.75rem; border-radius: 12px; color: white;">
                    </div>
                    
                    <!-- Quick Filters -->
                    <div style="margin-bottom: 1.5rem;">
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 500;">ë¹ ë¥¸ í•„í„°</label>
                        <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
                            <button onclick="applyQuickFilter('this-week')" style="padding: 0.5rem 1rem; background: rgba(139,92,246,0.2); border: 1px solid rgba(139,92,246,0.3); border-radius: 8px; color: white; cursor: pointer;">ì´ë²ˆ ì£¼</button>
                            <button onclick="applyQuickFilter('this-month')" style="padding: 0.5rem 1rem; background: rgba(139,92,246,0.2); border: 1px solid rgba(139,92,246,0.3); border-radius: 8px; color: white; cursor: pointer;">ì´ë²ˆ ë‹¬</button>
                            <button onclick="applyQuickFilter('urgent')" style="padding: 0.5rem 1rem; background: rgba(239,68,68,0.2); border: 1px solid rgba(239,68,68,0.3); border-radius: 8px; color: white; cursor: pointer;">ê¸´ê¸‰</button>
                        </div>
                    </div>
                    
                    <!-- Actions -->
                    <div style="display: flex; gap: 1rem;">
                        <button onclick="applyFilter()" style="flex: 1; padding: 0.75rem; background: linear-gradient(135deg, #8b5cf6, #ec4899); border: none; border-radius: 12px; color: white; font-weight: 600; cursor: pointer;">í•„í„° ì ìš©</button>
                        <button onclick="resetFilter()" style="padding: 0.75rem 1.5rem; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.15); border-radius: 12px; color: white; cursor: pointer;">ì´ˆê¸°í™”</button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Searches Page -->
        <div id="searches-page" class="tool-page">
            <div style="max-width: 900px; margin: 0 auto;">
                <div style="background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 20px; padding: 2rem;">
                    <h2 style="font-size: 1.5rem; font-weight: 600; margin-bottom: 1.5rem;">ğŸ”– ì €ì¥ëœ ê²€ìƒ‰</h2>
                    <div id="saved-searches-list" style="display: grid; gap: 1rem;">
                        <p style="text-align: center; color: rgba(255,255,255,0.5); padding: 2rem;">ì €ì¥ëœ ê²€ìƒ‰ì´ ì—†ìŠµë‹ˆë‹¤.</p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Export Page -->
        <div id="export-page" class="tool-page">
            <div style="max-width: 800px; margin: 0 auto;">
                <div style="background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 20px; padding: 2rem;">
                    <h2 style="font-size: 1.5rem; font-weight: 600; margin-bottom: 1.5rem;">ğŸ“¤ ë‚´ë³´ë‚´ê¸° / ê°€ì ¸ì˜¤ê¸°</h2>
                    
                    <!-- Export Section -->
                    <div style="margin-bottom: 3rem;">
                        <h3 style="font-size: 1.25rem; font-weight: 600; margin-bottom: 1rem;">ë‚´ë³´ë‚´ê¸°</h3>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                            <button onclick="exportJSON()" style="padding: 1rem; background: linear-gradient(135deg, #10b981, #059669); border: none; border-radius: 12px; color: white; font-weight: 600; cursor: pointer; display: flex; align-items: center; gap: 0.5rem; justify-content: center;">
                                <i class="fas fa-file-code"></i> JSON
                            </button>
                            <button onclick="exportCSV()" style="padding: 1rem; background: linear-gradient(135deg, #3b82f6, #2563eb); border: none; border-radius: 12px; color: white; font-weight: 600; cursor: pointer; display: flex; align-items: center; gap: 0.5rem; justify-content: center;">
                                <i class="fas fa-file-csv"></i> CSV
                            </button>
                            <button onclick="exportExcel()" style="padding: 1rem; background: linear-gradient(135deg, #8b5cf6, #7c3aed); border: none; border-radius: 12px; color: white; font-weight: 600; cursor: pointer; display: flex; align-items: center; gap: 0.5rem; justify-content: center;">
                                <i class="fas fa-file-excel"></i> Excel
                            </button>
                        </div>
                    </div>
                    
                    <!-- Import Section -->
                    <div>
                        <h3 style="font-size: 1.25rem; font-weight: 600; margin-bottom: 1rem;">ê°€ì ¸ì˜¤ê¸°</h3>
                        <div style="background: rgba(255,255,255,0.03); border: 2px dashed rgba(255,255,255,0.2); border-radius: 12px; padding: 2rem; text-align: center;">
                            <input type="file" id="import-file" accept=".json" style="display: none;" onchange="handleImportFile(this)">
                            <button onclick="document.getElementById('import-file').click()" style="padding: 1rem 2rem; background: linear-gradient(135deg, #3b82f6, #2563eb); border: none; border-radius: 12px; color: white; font-weight: 600; cursor: pointer;">
                                <i class="fas fa-upload"></i> JSON íŒŒì¼ ì„ íƒ
                            </button>
                            <p style="margin-top: 1rem; color: rgba(255,255,255,0.5); font-size: 0.875rem;">JSON ë°±ì—… íŒŒì¼ì„ ì„ íƒí•˜ì—¬ ê°€ì ¸ì˜¤ê¸°</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Batch Page -->
        <div id="batch-page" class="tool-page">
            <div style="max-width: 900px; margin: 0 auto;">
                <div style="background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 20px; padding: 2rem;">
                    <h2 style="font-size: 1.5rem; font-weight: 600; margin-bottom: 1.5rem;">ğŸ“‹ ì¼ê´„ ì‘ì—…</h2>
                    
                    <div style="text-align: center; padding: 3rem;">
                        <div style="font-size: 4rem; margin-bottom: 1rem;">ğŸ“‹</div>
                        <h3 style="font-size: 1.25rem; font-weight: 600; margin-bottom: 0.5rem;">ì¼ê´„ ì‘ì—… ê¸°ëŠ¥</h3>
                        <p style="color: rgba(255,255,255,0.6); margin-bottom: 2rem;">ì—¬ëŸ¬ í”„ë¡œì íŠ¸ë¥¼ í•œ ë²ˆì— ì„ íƒí•˜ì—¬ ìƒíƒœ ë³€ê²½, ì‚­ì œ ë“±ì˜ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                        <a href="/dashboard.html" style="display: inline-block; padding: 1rem 2rem; background: linear-gradient(135deg, #8b5cf6, #ec4899); border-radius: 12px; color: white; font-weight: 600; text-decoration: none;">
                            ëŒ€ì‹œë³´ë“œë¡œ ì´ë™
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Page Navigation
        function loadTool(tool) {
            // Hide all pages
            document.querySelectorAll('.tool-page').forEach(page => {
                page.classList.remove('active');
            });
            
            // Show selected page
            const page = document.getElementById(`${tool}-page`);
            if (page) {
                page.classList.add('active');
                
                // Update title
                const titles = {
                    'templates': 'ğŸ“‹ í”„ë¡œì íŠ¸ í…œí”Œë¦¿',
                    'filter': 'ğŸ” ê³ ê¸‰ í•„í„°',
                    'searches': 'ğŸ”– ì €ì¥ëœ ê²€ìƒ‰',
                    'export': 'ğŸ“¤ ë‚´ë³´ë‚´ê¸° / ê°€ì ¸ì˜¤ê¸°',
                    'batch': 'ğŸ“‹ ì¼ê´„ ì‘ì—…'
                };
                document.getElementById('title-text').textContent = titles[tool] || 'Workflow Tools';
                
                // Update URL
                const url = new URL(window.location);
                url.searchParams.set('tool', tool);
                window.history.pushState({}, '', url);
            }
        }
        
        // Template Functions
        async function createProjectFromTemplate(templateType) {
            const token = localStorage.getItem('token');
            if (!token) {
                alert('ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.');
                window.location.href = '/login.html';
                return;
            }
            
            try {
                const response = await fetch(`${API_BASE_URL}/api/projects/from-template`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${token}`
                    },
                    body: JSON.stringify({ templateType })
                });
                
                if (response.ok) {
                    const project = await response.json();
                    alert(`âœ… í”„ë¡œì íŠ¸ê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!`);
                    window.location.href = '/dashboard.html';
                } else {
                    throw new Error('Failed to create project');
                }
            } catch (error) {
                console.error('Error:', error);
                alert('âŒ í”„ë¡œì íŠ¸ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
            }
        }
        
        // Filter Functions
        function applyQuickFilter(type) {
            const now = new Date();
            let startDate, endDate;
            
            if (type === 'this-week') {
                const day = now.getDay();
                startDate = new Date(now);
                startDate.setDate(now.getDate() - day);
                endDate = new Date(startDate);
                endDate.setDate(startDate.getDate() + 6);
            } else if (type === 'this-month') {
                startDate = new Date(now.getFullYear(), now.getMonth(), 1);
                endDate = new Date(now.getFullYear(), now.getMonth() + 1, 0);
            } else if (type === 'urgent') {
                startDate = now;
                endDate = new Date(now);
                endDate.setDate(now.getDate() + 7);
            }
            
            document.getElementById('filter-start-date').value = startDate.toISOString().split('T')[0];
            document.getElementById('filter-end-date').value = endDate.toISOString().split('T')[0];
        }
        
        function applyFilter() {
            const filters = {
                startDate: document.getElementById('filter-start-date').value,
                endDate: document.getElementById('filter-end-date').value,
                keyword: document.getElementById('filter-keyword').value,
                curator: document.getElementById('filter-curator').value,
                location: document.getElementById('filter-location').value
            };
            
            // Save to sessionStorage and redirect to dashboard
            sessionStorage.setItem('pendingFilters', JSON.stringify(filters));
            alert('í•„í„°ê°€ ì ìš©ë˜ì—ˆìŠµë‹ˆë‹¤! ëŒ€ì‹œë³´ë“œë¡œ ì´ë™í•©ë‹ˆë‹¤.');
            window.location.href = '/dashboard.html';
        }
        
        function resetFilter() {
            document.getElementById('filter-start-date').value = '';
            document.getElementById('filter-end-date').value = '';
            document.getElementById('filter-keyword').value = '';
            document.getElementById('filter-curator').value = '';
            document.getElementById('filter-location').value = '';
        }
        
        // Saved Searches Functions
        function loadSavedSearches() {
            const searches = JSON.parse(localStorage.getItem('museflow_saved_searches') || '[]');
            const container = document.getElementById('saved-searches-list');
            
            if (searches.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: rgba(255,255,255,0.5); padding: 2rem;">ì €ì¥ëœ ê²€ìƒ‰ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
                return;
            }
            
            container.innerHTML = searches.map(search => `
                <div style="background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.1); border-radius: 12px; padding: 1.5rem;">
                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 1rem;">
                        <h3 style="font-size: 1.125rem; font-weight: 600;">${search.name}</h3>
                        <div style="display: flex; gap: 0.5rem;">
                            <button onclick="loadSearch('${search.id}')" style="padding: 0.5rem 1rem; background: linear-gradient(135deg, #8b5cf6, #ec4899); border: none; border-radius: 8px; color: white; cursor: pointer; font-size: 0.875rem;">ë¶ˆëŸ¬ì˜¤ê¸°</button>
                            <button onclick="deleteSearch('${search.id}')" style="padding: 0.5rem 1rem; background: rgba(239,68,68,0.2); border: 1px solid rgba(239,68,68,0.3); border-radius: 8px; color: white; cursor: pointer; font-size: 0.875rem;">ì‚­ì œ</button>
                        </div>
                    </div>
                    <div style="display: flex; flex-wrap: wrap; gap: 0.5rem;">
                        ${search.conditions.type ? `<span style="padding: 0.25rem 0.75rem; background: rgba(139,92,246,0.2); border-radius: 20px; font-size: 0.75rem;">ìœ í˜•: ${search.conditions.type}</span>` : ''}
                        ${search.conditions.phase ? `<span style="padding: 0.25rem 0.75rem; background: rgba(16,185,129,0.2); border-radius: 20px; font-size: 0.75rem;">ë‹¨ê³„: ${search.conditions.phase}</span>` : ''}
                        ${search.conditions.keyword ? `<span style="padding: 0.25rem 0.75rem; background: rgba(245,158,11,0.2); border-radius: 20px; font-size: 0.75rem;">í‚¤ì›Œë“œ: ${search.conditions.keyword}</span>` : ''}
                    </div>
                </div>
            `).join('');
        }
        
        function loadSearch(id) {
            const searches = JSON.parse(localStorage.getItem('museflow_saved_searches') || '[]');
            const search = searches.find(s => s.id === id);
            if (search) {
                sessionStorage.setItem('pendingFilters', JSON.stringify(search.conditions));
                alert('ê²€ìƒ‰ì´ ë¶ˆëŸ¬ì™€ì¡ŒìŠµë‹ˆë‹¤! ëŒ€ì‹œë³´ë“œë¡œ ì´ë™í•©ë‹ˆë‹¤.');
                window.location.href = '/dashboard.html';
            }
        }
        
        function deleteSearch(id) {
            if (confirm('ì´ ê²€ìƒ‰ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                let searches = JSON.parse(localStorage.getItem('museflow_saved_searches') || '[]');
                searches = searches.filter(s => s.id !== id);
                localStorage.setItem('museflow_saved_searches', JSON.stringify(searches));
                loadSavedSearches();
                alert('ê²€ìƒ‰ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
            }
        }
        
        // Export/Import Functions
        async function exportJSON() {
            const token = localStorage.getItem('token');
            if (!token) {
                alert('ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.');
                window.location.href = '/login.html';
                return;
            }
            
            try {
                const response = await fetch(`${API_BASE_URL}/api/projects`, {
                    headers: { 'Authorization': `Bearer ${token}` }
                });
                const projects = await response.json();
                
                const dataStr = JSON.stringify(projects, null, 2);
                const dataBlob = new Blob([dataStr], { type: 'application/json' });
                const url = URL.createObjectURL(dataBlob);
                const link = document.createElement('a');
                link.href = url;
                link.download = `museflow-projects-${new Date().toISOString().split('T')[0]}.json`;
                link.click();
                URL.revokeObjectURL(url);
                
                alert('âœ… JSON íŒŒì¼ì´ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!');
            } catch (error) {
                console.error('Export error:', error);
                alert('âŒ ë‚´ë³´ë‚´ê¸° ì‹¤íŒ¨');
            }
        }
        
        async function exportCSV() {
            const token = localStorage.getItem('token');
            if (!token) {
                alert('ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.');
                window.location.href = '/login.html';
                return;
            }
            
            try {
                const response = await fetch(`${API_BASE_URL}/api/projects`, {
                    headers: { 'Authorization': `Bearer ${token}` }
                });
                const projects = await response.json();
                
                const headers = ['ID', 'ì œëª©', 'ìœ í˜•', 'ë‹¨ê³„', 'ì‹œì‘ì¼', 'ë§ˆê°ì¼', 'ë‹´ë‹¹ì'];
                const rows = projects.map(p => [
                    p.id,
                    p.title,
                    p.type,
                    p.phase,
                    p.start_date || '',
                    p.end_date || '',
                    p.curator || ''
                ]);
                
                const csvContent = [headers, ...rows].map(row => row.join(',')).join('\n');
                const blob = new Blob(['\ufeff' + csvContent], { type: 'text/csv;charset=utf-8;' });
                const url = URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = `museflow-projects-${new Date().toISOString().split('T')[0]}.csv`;
                link.click();
                URL.revokeObjectURL(url);
                
                alert('âœ… CSV íŒŒì¼ì´ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!');
            } catch (error) {
                console.error('Export error:', error);
                alert('âŒ ë‚´ë³´ë‚´ê¸° ì‹¤íŒ¨');
            }
        }
        
        async function exportExcel() {
            alert('Excel ë‚´ë³´ë‚´ê¸°ëŠ” Dashboardì—ì„œ ì´ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.');
            window.location.href = '/dashboard.html';
        }
        
        async function handleImportFile(input) {
            if (!input.files || !input.files[0]) return;
            
            const file = input.files[0];
            const reader = new FileReader();
            
            reader.onload = async (e) => {
                try {
                    const projects = JSON.parse(e.target.result);
                    
                    if (!confirm(`${projects.length}ê°œì˜ í”„ë¡œì íŠ¸ë¥¼ ê°€ì ¸ì˜¤ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                        return;
                    }
                    
                    const token = localStorage.getItem('token');
                    if (!token) {
                        alert('ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.');
                        window.location.href = '/login.html';
                        return;
                    }
                    
                    // Import projects one by one
                    let success = 0;
                    for (const project of projects) {
                        try {
                            await fetch(`${API_BASE_URL}/api/projects`, {
                                method: 'POST',
                                headers: {
                                    'Content-Type': 'application/json',
                                    'Authorization': `Bearer ${token}`
                                },
                                body: JSON.stringify(project)
                            });
                            success++;
                        } catch (err) {
                            console.error('Import error:', err);
                        }
                    }
                    
                    alert(`âœ… ${success}/${projects.length}ê°œ í”„ë¡œì íŠ¸ê°€ ê°€ì ¸ì™€ì¡ŒìŠµë‹ˆë‹¤!`);
                    window.location.href = '/dashboard.html';
                } catch (error) {
                    console.error('Parse error:', error);
                    alert('âŒ íŒŒì¼ í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.');
                }
            };
            
            reader.readAsText(file);
        }
        
        // Check URL on load
        document.addEventListener('DOMContentLoaded', () => {
            const params = new URLSearchParams(window.location.search);
            const tool = params.get('tool');
            if (tool) {
                loadTool(tool);
                
                // Load saved searches if on searches page
                if (tool === 'searches') {
                    loadSavedSearches();
                }
            }
        });
    </script>
</body>
</html>
