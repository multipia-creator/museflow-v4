<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="version" content="4.9.0">
    <title>Dashboard - MuseFlow</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="/static/js/tracker.js?v=4.0.0"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #000000;
            color: #f5f5f7;
            -webkit-font-smoothing: antialiased;
        }
        
        /* Apple-style Navigation */
        .nav {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 48px;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: saturate(180%) blur(20px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            z-index: 9999;
        }
        
        .nav-content {
            max-width: 1400px;
            margin: 0 auto;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
        }
        
        .nav-logo {
            font-size: 20px;
            font-weight: 600;
            color: #f5f5f7;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .nav-logo-icon {
            width: 28px;
            height: 28px;
            background: linear-gradient(135deg, #8b5cf6, #ec4899);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
        }
        
        .nav-links {
            display: flex;
            gap: 32px;
        }
        
        .nav-link {
            font-size: 12px;
            font-weight: 400;
            color: #f5f5f7;
            text-decoration: none;
            opacity: 0.8;
            transition: opacity 0.2s;
        }
        
        .nav-link:hover {
            opacity: 1;
        }
        
        /* Main Container */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 80px 20px 40px;
        }
        
        /* Hero Section */
        .hero {
            text-align: center;
            padding: 60px 0;
        }
        
        .hero-title {
            font-size: 64px;
            font-weight: 700;
            letter-spacing: -0.02em;
            background: linear-gradient(135deg, #ffffff, #a0a0a0);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 16px;
        }
        
        .hero-subtitle {
            font-size: 28px;
            font-weight: 400;
            color: #a1a1a6;
            margin-bottom: 40px;
        }
        
        /* Module Cards Grid */
        .modules-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 60px;
        }
        
        .module-card {
            position: relative;
            background: #1d1d1f;
            border-radius: 18px;
            padding: 40px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .module-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, var(--gradient-start), var(--gradient-end));
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .module-card:hover {
            transform: scale(1.02);
            border-color: rgba(255, 255, 255, 0.2);
        }
        
        .module-card:hover::before {
            opacity: 0.1;
        }
        
        .module-icon {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--gradient-start), var(--gradient-end));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            margin-bottom: 20px;
            position: relative;
            z-index: 1;
        }
        
        .module-content {
            position: relative;
            z-index: 1;
        }
        
        .module-title {
            font-size: 24px;
            font-weight: 600;
            color: #f5f5f7;
            margin-bottom: 8px;
        }
        
        .module-description {
            font-size: 14px;
            color: #86868b;
            margin-bottom: 20px;
            line-height: 1.5;
        }
        
        .module-stats {
            display: flex;
            gap: 20px;
            font-size: 13px;
            color: #86868b;
        }
        
        .module-stat-value {
            font-weight: 600;
            color: #f5f5f7;
            margin-right: 4px;
        }
        
        /* Projects Section */
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }
        
        .section-title {
            font-size: 32px;
            font-weight: 700;
            color: #f5f5f7;
        }
        
        .btn-primary {
            background: #0071e3;
            color: white;
            border: none;
            border-radius: 980px;
            padding: 12px 24px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .btn-primary:hover {
            background: #0077ed;
        }
        
        .projects-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(340px, 1fr));
            gap: 20px;
            margin-bottom: 60px;
        }
        
        .project-card {
            background: #1d1d1f;
            border-radius: 18px;
            padding: 30px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s;
            cursor: pointer;
        }
        
        .project-card:hover {
            transform: translateY(-4px);
            border-color: rgba(139, 92, 246, 0.5);
        }
        
        .project-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 16px;
        }
        
        .project-type {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .project-title {
            font-size: 20px;
            font-weight: 600;
            color: #f5f5f7;
            margin-bottom: 8px;
        }
        
        .project-description {
            font-size: 14px;
            color: #86868b;
            margin-bottom: 20px;
            line-height: 1.5;
        }
        
        .project-actions {
            display: flex;
            gap: 8px;
        }
        
        .btn-action {
            flex: 1;
            padding: 10px;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            background: transparent;
            color: #f5f5f7;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .btn-action:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.3);
        }
        
        @media (max-width: 1024px) {
            .modules-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .hero-title {
                font-size: 48px;
            }
            
            .hero-subtitle {
                font-size: 21px;
            }
        }
        
        @media (max-width: 640px) {
            .modules-grid {
                grid-template-columns: 1fr;
            }
            
            .hero-title {
                font-size: 36px;
            }
            
            .hero-subtitle {
                font-size: 18px;
            }
            
            .nav-links {
                display: none;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="nav">
        <div class="nav-content">
            <a href="/dashboard" class="nav-logo">
                <div class="nav-logo-icon">M</div>
                MuseFlow
            </a>
            <div class="nav-links">
                <a href="/dashboard" class="nav-link">Dashboard</a>
                <a href="/projects" class="nav-link">Projects</a>
                <a href="/account" class="nav-link">Account</a>
            </div>
        </div>
    </nav>

    <!-- Main Container -->
    <div class="container">
        <!-- Hero Section -->
        <div class="hero">
            <h1 class="hero-title">Museum Workflow</h1>
            <p class="hero-subtitle">6ê°œ ëª¨ë“ˆë¡œ ë°•ë¬¼ê´€ ì—…ë¬´ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ê´€ë¦¬í•˜ì„¸ìš”</p>
        </div>

        <!-- Museum Modules -->
        <div class="modules-grid">
            <!-- Exhibition Module -->
            <div class="module-card" style="--gradient-start: #8b5cf6; --gradient-end: #a78bfa;" onclick="openModule('exhibition')">
                <div class="module-icon">ğŸ¨</div>
                <div class="module-content">
                    <h3 class="module-title">ì „ì‹œ ê´€ë¦¬</h3>
                    <p class="module-description">ì „ì‹œ ê¸°íšë¶€í„° ìš´ì˜ê¹Œì§€ ì „ì²´ í”„ë¡œì„¸ìŠ¤ ê´€ë¦¬</p>
                    <div class="module-stats">
                        <span><span class="module-stat-value">15</span>ì›Œí¬í”Œë¡œìš°</span>
                        <span><span class="module-stat-value" id="exhibition-count">0</span>í”„ë¡œì íŠ¸</span>
                    </div>
                </div>
            </div>

            <!-- Education Module -->
            <div class="module-card" style="--gradient-start: #06b6d4; --gradient-end: #22d3ee;" onclick="openModule('education')">
                <div class="module-icon">ğŸ“</div>
                <div class="module-content">
                    <h3 class="module-title">êµìœ¡ í”„ë¡œê·¸ë¨</h3>
                    <p class="module-description">êµìœ¡ í”„ë¡œê·¸ë¨ ê°œë°œ ë° ì‹¤í–‰</p>
                    <div class="module-stats">
                        <span><span class="module-stat-value">15</span>ì›Œí¬í”Œë¡œìš°</span>
                        <span><span class="module-stat-value" id="education-count">0</span>í”„ë¡œì íŠ¸</span>
                    </div>
                </div>
            </div>

            <!-- Archive Module -->
            <div class="module-card" style="--gradient-start: #10b981; --gradient-end: #34d399;" onclick="openModule('archive')">
                <div class="module-icon">ğŸ“¦</div>
                <div class="module-content">
                    <h3 class="module-title">ìˆ˜ì§‘ & ë³´ì¡´</h3>
                    <p class="module-description">ìœ ë¬¼ ìˆ˜ì§‘, ë“±ë¡, ë³´ì¡´ ê´€ë¦¬</p>
                    <div class="module-stats">
                        <span><span class="module-stat-value">15</span>ì›Œí¬í”Œë¡œìš°</span>
                        <span><span class="module-stat-value" id="archive-count">0</span>í”„ë¡œì íŠ¸</span>
                    </div>
                </div>
            </div>

            <!-- Publication Module -->
            <div class="module-card" style="--gradient-start: #f59e0b; --gradient-end: #fbbf24;" onclick="openModule('publication')">
                <div class="module-icon">ğŸ“š</div>
                <div class="module-content">
                    <h3 class="module-title">ì¶œíŒ & ì½˜í…ì¸ </h3>
                    <p class="module-description">ë„ë¡, ë‰´ìŠ¤ë ˆí„°, ë””ì§€í„¸ ì½˜í…ì¸  ì œì‘</p>
                    <div class="module-stats">
                        <span><span class="module-stat-value">12</span>ì›Œí¬í”Œë¡œìš°</span>
                        <span><span class="module-stat-value" id="publication-count">0</span>í”„ë¡œì íŠ¸</span>
                    </div>
                </div>
            </div>

            <!-- Research Module -->
            <div class="module-card" style="--gradient-start: #ec4899; --gradient-end: #f472b6;" onclick="openModule('research')">
                <div class="module-icon">ğŸ”¬</div>
                <div class="module-content">
                    <h3 class="module-title">ì—°êµ¬ & ì¡°ì‚¬</h3>
                    <p class="module-description">í•™ìˆ  ì—°êµ¬ ë° í˜„ì¥ ì¡°ì‚¬</p>
                    <div class="module-stats">
                        <span><span class="module-stat-value">12</span>ì›Œí¬í”Œë¡œìš°</span>
                        <span><span class="module-stat-value" id="research-count">0</span>í”„ë¡œì íŠ¸</span>
                    </div>
                </div>
            </div>

            <!-- Admin Module -->
            <div class="module-card" style="--gradient-start: #6366f1; --gradient-end: #818cf8;" onclick="openModule('admin')">
                <div class="module-icon">ğŸ¢</div>
                <div class="module-content">
                    <h3 class="module-title">í–‰ì • & ìš´ì˜</h3>
                    <p class="module-description">ì˜ˆì‚°, ì¸ì‚¬, ì‹œì„¤ ê´€ë¦¬</p>
                    <div class="module-stats">
                        <span><span class="module-stat-value">19</span>ì›Œí¬í”Œë¡œìš°</span>
                        <span><span class="module-stat-value" id="admin-count">0</span>í”„ë¡œì íŠ¸</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Projects Section -->
        <div class="section-header">
            <h2 class="section-title">ì§„í–‰ ì¤‘ì¸ í”„ë¡œì íŠ¸</h2>
            <button class="btn-primary" onclick="createProject()">
                <i class="fas fa-plus"></i> ìƒˆ í”„ë¡œì íŠ¸
            </button>
        </div>

        <div class="projects-grid" id="projects-grid">
            <!-- Projects will be loaded here -->
        </div>
    </div>

    <!-- API Client -->
    <script src="/static/js/api-client-d1.js"></script>

    <script>
        // Module navigation
        function openModule(module) {
            console.log('ğŸ¯ Opening module:', module);
            
            // Check if module project exists
            const moduleProjectId = localStorage.getItem(`module_project_${module}`);
            
            if (moduleProjectId) {
                // Open existing module project workflow
                window.location.href = `/workflow?project=${moduleProjectId}&module=${module}`;
            } else {
                // Create new module project
                createModuleProject(module);
            }
        }
        
        // Create module project
        async function createModuleProject(module) {
            const moduleData = {
                'exhibition': { title: 'ì „ì‹œ ê´€ë¦¬', type: 'special', description: 'ì „ì‹œ ê¸°íšë¶€í„° ìš´ì˜ê¹Œì§€' },
                'education': { title: 'êµìœ¡ í”„ë¡œê·¸ë¨', type: 'event', description: 'êµìœ¡ í”„ë¡œê·¸ë¨ ê°œë°œ ë° ì‹¤í–‰' },
                'archive': { title: 'ìˆ˜ì§‘ & ë³´ì¡´', type: 'permanent', description: 'ìœ ë¬¼ ìˆ˜ì§‘, ë“±ë¡, ë³´ì¡´' },
                'publication': { title: 'ì¶œíŒ & ì½˜í…ì¸ ', type: 'event', description: 'ë„ë¡ ë° ë””ì§€í„¸ ì½˜í…ì¸ ' },
                'research': { title: 'ì—°êµ¬ & ì¡°ì‚¬', type: 'special', description: 'í•™ìˆ  ì—°êµ¬ ë° ì¡°ì‚¬' },
                'admin': { title: 'í–‰ì • & ìš´ì˜', type: 'permanent', description: 'ì˜ˆì‚°, ì¸ì‚¬, ì‹œì„¤ ê´€ë¦¬' }
            };
            
            const data = moduleData[module];
            
            try {
                const result = await window.apiClient.projects.create({
                    title: data.title,
                    description: data.description,
                    type: data.type,
                    phase: 'planning'
                });
                
                if (result.success && result.data) {
                    const projectId = result.data.id;
                    localStorage.setItem(`module_project_${module}`, projectId);
                    window.location.href = `/workflow?project=${projectId}&module=${module}`;
                } else {
                    alert('í”„ë¡œì íŠ¸ ìƒì„± ì‹¤íŒ¨');
                }
            } catch (error) {
                console.error('Error:', error);
                alert('ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤');
            }
        }
        
        // Create new project
        function createProject() {
            alert('í”„ë¡œì íŠ¸ ìƒì„± ëª¨ë‹¬ì€ ê°œë°œ ì¤‘ì…ë‹ˆë‹¤.');
        }
        
        // Load projects
        async function loadProjects() {
            try {
                const result = await window.apiClient.projects.list();
                
                if (result.success && result.data) {
                    const projects = result.data;
                    renderProjects(projects);
                    updateModuleCounts(projects);
                }
            } catch (error) {
                console.error('Error loading projects:', error);
            }
        }
        
        // Render projects
        function renderProjects(projects) {
            const grid = document.getElementById('projects-grid');
            
            if (projects.length === 0) {
                grid.innerHTML = '<p style="text-align: center; color: #86868b; padding: 40px;">ì•„ì§ í”„ë¡œì íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
                return;
            }
            
            const typeColors = {
                'special': '#8b5cf6',
                'permanent': '#10b981',
                'traveling': '#06b6d4',
                'event': '#f59e0b'
            };
            
            const typeLabels = {
                'special': 'íŠ¹ë³„ì „',
                'permanent': 'ìƒì„¤ì „',
                'traveling': 'ìˆœíšŒì „',
                'event': 'ê¸°íšì „'
            };
            
            grid.innerHTML = projects.map(project => `
                <div class="project-card" onclick="openProject(${project.id})">
                    <div class="project-header">
                        <div class="project-type" style="background: ${typeColors[project.type]}20; color: ${typeColors[project.type]}">
                            ${typeLabels[project.type] || project.type}
                        </div>
                    </div>
                    <h3 class="project-title">${project.title}</h3>
                    <p class="project-description">${project.description || 'ì„¤ëª… ì—†ìŒ'}</p>
                    <div class="project-actions">
                        <button class="btn-action" onclick="event.stopPropagation(); openCanvas(${project.id}, 'tasks')">
                            <i class="fas fa-tasks"></i> Tasks
                        </button>
                        <button class="btn-action" onclick="event.stopPropagation(); openCanvas(${project.id}, 'workflow')">
                            <i class="fas fa-project-diagram"></i> Workflow
                        </button>
                    </div>
                </div>
            `).join('');
        }
        
        // Update module counts
        function updateModuleCounts(projects) {
            // This is a simplified version - in real app, categorize by module
            const counts = {
                exhibition: projects.filter(p => p.type === 'special').length,
                education: projects.filter(p => p.type === 'event').length,
                archive: projects.filter(p => p.type === 'permanent').length,
                publication: 0,
                research: 0,
                admin: 0
            };
            
            Object.keys(counts).forEach(module => {
                const el = document.getElementById(`${module}-count`);
                if (el) el.textContent = counts[module];
            });
        }
        
        // Open project
        function openProject(projectId) {
            window.location.href = `/canvas?project=${projectId}`;
        }
        
        // Open canvas
        function openCanvas(projectId, type) {
            if (type === 'workflow') {
                window.location.href = `/workflow?project=${projectId}`;
            } else {
                window.location.href = `/canvas?project=${projectId}`;
            }
        }
        
        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            loadProjects();
        });
    </script>
</body>
</html>
