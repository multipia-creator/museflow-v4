<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MuseFlow - Canvas V4 Hybrid Layout</title>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- External Libraries -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <!-- MuseFlow Design System -->
    <link href="/static/css/museflow-design-system.css" rel="stylesheet">
    <link href="/static/css/unified-navbar.css" rel="stylesheet">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: var(--font-family);
            background: var(--museflow-bg-secondary);
            color: var(--museflow-text-primary);
            overflow: hidden;
            padding-top: 64px; /* Space for Unified Navbar */
        }
        
        /* 3-Column Layout */
        .canvas-container {
            display: grid;
            grid-template-columns: 300px 1fr 400px;
            height: calc(100vh - 64px);
            gap: 0;
        }
        
        /* Left Column - History & Projects */
        .left-column {
            background: #FFFFFF;
            border-right: 1px solid #E5E7EB;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        .column-header {
            padding: 1.5rem;
            border-bottom: 1px solid #E5E7EB;
        }
        
        .column-title {
            font-size: 1.125rem;
            font-weight: 700;
            color: #111827;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        /* Quick Actions Panel */
        .quick-actions-panel {
            padding: 1rem;
            border-bottom: 1px solid var(--museflow-border-light);
            background: var(--museflow-bg-secondary);
        }
        
        .quick-actions-header {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.875rem;
            font-weight: 700;
            color: var(--museflow-text-secondary);
            margin-bottom: 0.75rem;
        }
        
        .quick-actions-header i {
            color: var(--museflow-primary);
        }
        
        .quick-actions-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.5rem;
        }
        
        .quick-action-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.375rem;
            padding: 0.75rem 0.5rem;
            background: white;
            border: 1px solid var(--museflow-border-light);
            border-radius: var(--radius-md);
            font-size: 0.6875rem;
            font-weight: 600;
            color: var(--museflow-text-secondary);
            cursor: pointer;
            transition: var(--transition-base);
        }
        
        .quick-action-btn i {
            font-size: 1.25rem;
            color: var(--museflow-primary);
            transition: var(--transition-base);
        }
        
        .quick-action-btn:hover {
            background: var(--museflow-primary-light);
            border-color: var(--museflow-primary);
            color: var(--museflow-primary);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(139, 92, 246, 0.15);
        }
        
        .quick-action-btn:hover i {
            transform: scale(1.1);
        }
        
        .quick-action-btn:active {
            transform: translateY(0);
        }
        
        .history-list {
            flex: 1;
            overflow-y: auto;
            padding: 1rem;
        }
        
        .history-item {
            background: #F9FAFB;
            border: 1px solid #E5E7EB;
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 0.75rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .history-item:hover {
            background: var(--museflow-bg-tertiary);
            border-color: var(--museflow-primary);
            transform: translateX(4px);
        }
        
        .history-item.active {
            background: linear-gradient(135deg, var(--museflow-primary) 0%, var(--museflow-primary-dark) 100%);
            color: white;
            border-color: transparent;
        }
        
        .history-title {
            font-weight: 600;
            font-size: 0.875rem;
            margin-bottom: 0.25rem;
        }
        
        .history-meta {
            font-size: 0.75rem;
            opacity: 0.7;
            display: flex;
            justify-content: space-between;
        }
        
        /* Center Column - AI Conversation */
        .center-column {
            background: #FFFFFF;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        .conversation-header {
            padding: 1.5rem;
            border-bottom: 1px solid #E5E7EB;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .ai-status-badge {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: #ECFDF5;
            border-radius: 8px;
            font-size: 0.875rem;
            font-weight: 600;
            color: #059669;
        }
        
        .ai-status-badge i {
            animation: pulse 2s infinite;
        }
        
        .conversation-area {
            flex: 1;
            overflow-y: auto;
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        
        .message {
            display: flex;
            gap: 1rem;
            animation: slideIn 0.3s ease;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .message.user {
            justify-content: flex-end;
        }
        
        .message-avatar {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
            flex-shrink: 0;
        }
        
        .message.ai .message-avatar {
            background: linear-gradient(135deg, var(--museflow-primary) 0%, var(--museflow-primary-dark) 100%);
            color: white;
        }
        
        .message.user .message-avatar {
            background: #F3F4F6;
            color: #6B7280;
        }
        
        .message-content {
            max-width: 70%;
            background: #F9FAFB;
            border: 1px solid #E5E7EB;
            border-radius: 16px;
            padding: 1rem;
        }
        
        .message.user .message-content {
            background: linear-gradient(135deg, var(--museflow-primary) 0%, var(--museflow-primary-dark) 100%);
            color: white;
            border-color: transparent;
        }
        
        .message-text {
            font-size: 0.9375rem;
            line-height: 1.6;
            margin-bottom: 0.5rem;
        }
        
        .message-timestamp {
            font-size: 0.75rem;
            opacity: 0.6;
        }
        
        .phase-progress {
            background: #FEF3C7;
            border: 1px solid #FCD34D;
            border-radius: 12px;
            padding: 1rem;
            margin-top: 0.5rem;
        }
        
        .phase-title {
            font-weight: 600;
            color: #92400E;
            margin-bottom: 0.5rem;
            font-size: 0.875rem;
        }
        
        .phase-bar {
            background: #FDE68A;
            border-radius: 4px;
            height: 6px;
            overflow: hidden;
        }
        
        .phase-bar-fill {
            background: #F59E0B;
            height: 100%;
            transition: width 0.5s ease;
        }
        
        .input-area {
            padding: 1.5rem;
            border-top: 1px solid #E5E7EB;
            background: #FFFFFF;
        }
        
        .input-container {
            display: flex;
            gap: 1rem;
            align-items: flex-end;
        }
        
        .input-box {
            flex: 1;
            background: #F9FAFB;
            border: 2px solid #E5E7EB;
            border-radius: 12px;
            padding: 1rem;
            font-size: 1rem;
            font-family: 'Inter', sans-serif;
            resize: none;
            min-height: 60px;
            max-height: 150px;
            transition: all 0.3s ease;
        }
        
        .input-box:focus {
            outline: none;
            border-color: #667eea;
            background: #FFFFFF;
        }
        
        .send-button {
            width: 50px;
            height: 50px;
            border: none;
            border-radius: var(--radius-md);
            background: linear-gradient(135deg, var(--museflow-primary) 0%, var(--museflow-primary-dark) 100%);
            color: white;
            font-size: 1.25rem;
            cursor: pointer;
            transition: var(--transition-base);
            flex-shrink: 0;
        }
        
        .send-button:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(139, 92, 246, 0.3);
        }
        
        .send-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        /* Right Column - Live Canvas/Dashboard Preview */
        .right-column {
            background: #F9FAFB;
            border-left: 1px solid #E5E7EB;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        .preview-tabs {
            display: flex;
            border-bottom: 1px solid #E5E7EB;
            background: #FFFFFF;
        }
        
        .preview-tab {
            flex: 1;
            padding: 1rem;
            text-align: center;
            font-weight: 600;
            font-size: 0.875rem;
            color: #6B7280;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.2s ease;
        }
        
        .preview-tab:hover {
            background: #F9FAFB;
            color: #111827;
        }
        
        .preview-tab.active {
            color: #667eea;
            border-bottom-color: #667eea;
            background: #FFFFFF;
        }
        
        .preview-content {
            flex: 1;
            overflow-y: auto;
            padding: 1.5rem;
        }
        
        .preview-panel {
            display: none;
        }
        
        .preview-panel.active {
            display: block;
        }
        
        /* Live Stats Cards */
        .live-stats {
            display: grid;
            grid-template-columns: 1fr;
            gap: 0.75rem;
            padding: 1rem;
        }
        
        .stat-card-mini {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.875rem;
            background: white;
            border: 1px solid var(--museflow-border-light);
            border-radius: var(--radius-md);
            transition: var(--transition-base);
        }
        
        .stat-card-mini:hover {
            border-color: var(--museflow-primary);
            box-shadow: 0 2px 8px rgba(139, 92, 246, 0.1);
        }
        
        .stat-icon {
            width: 40px;
            height: 40px;
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.125rem;
            flex-shrink: 0;
        }
        
        .stat-info {
            flex: 1;
        }
        
        .stat-label {
            font-size: 0.75rem;
            color: var(--museflow-text-secondary);
            margin-bottom: 0.125rem;
        }
        
        .stat-value {
            font-size: 1.125rem;
            font-weight: 700;
            color: var(--museflow-text-primary);
        }
        
        /* Section Headers */
        .section-header {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1rem;
            background: var(--museflow-bg-tertiary);
            border-bottom: 1px solid var(--museflow-border-light);
            font-size: 0.875rem;
            font-weight: 700;
            color: var(--museflow-text-secondary);
        }
        
        .section-header i {
            color: var(--museflow-primary);
        }
        
        /* Active Tasks */
        .active-tasks-section {
            margin-top: 1rem;
            background: white;
            border: 1px solid var(--museflow-border-light);
            border-radius: var(--radius-md);
            overflow: hidden;
        }
        
        .active-tasks-list {
            padding: 1rem;
        }
        
        .no-tasks {
            text-align: center;
            padding: 2rem 1rem;
            color: var(--museflow-text-tertiary);
        }
        
        .no-tasks i {
            font-size: 2rem;
            margin-bottom: 0.5rem;
            opacity: 0.3;
        }
        
        .no-tasks p {
            font-size: 0.875rem;
        }
        
        /* Recent Items */
        .recent-items-section {
            margin-top: 1rem;
            background: white;
            border: 1px solid var(--museflow-border-light);
            border-radius: var(--radius-md);
            overflow: hidden;
        }
        
        .recent-items-list {
            padding: 0.5rem;
        }
        
        .recent-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem;
            border-radius: var(--radius-sm);
            transition: var(--transition-base);
            cursor: pointer;
        }
        
        .recent-item:hover {
            background: var(--museflow-bg-tertiary);
        }
        
        .recent-icon {
            font-size: 1.5rem;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--museflow-bg-secondary);
            border-radius: var(--radius-sm);
            flex-shrink: 0;
        }
        
        .recent-info {
            flex: 1;
        }
        
        .recent-title {
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--museflow-text-primary);
            margin-bottom: 0.125rem;
        }
        
        .recent-time {
            font-size: 0.75rem;
            color: var(--museflow-text-tertiary);
        }
        
        /* Widgets Grid */
        .widgets-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1rem;
            padding: 1rem;
        }
        
        .widget-card {
            background: white;
            border: 1px solid var(--museflow-border-light);
            border-radius: var(--radius-md);
            padding: 1rem;
            transition: var(--transition-base);
        }
        
        .widget-card:hover {
            border-color: var(--museflow-primary);
            box-shadow: 0 4px 12px rgba(139, 92, 246, 0.1);
        }
        
        .widget-header-small {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.8125rem;
            font-weight: 700;
            color: var(--museflow-text-secondary);
            margin-bottom: 0.75rem;
        }
        
        .widget-header-small i {
            color: var(--museflow-primary);
        }
        
        .widget-value {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--museflow-text-primary);
            margin-bottom: 0.5rem;
        }
        
        .widget-progress {
            height: 6px;
            background: var(--museflow-bg-tertiary);
            border-radius: 3px;
            overflow: hidden;
            margin-bottom: 0.5rem;
        }
        
        .widget-progress-bar {
            height: 100%;
            transition: width 0.3s ease;
        }
        
        .widget-footer {
            font-size: 0.75rem;
            color: var(--museflow-text-tertiary);
        }
        
        .widget-list {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        
        .widget-list-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem;
            background: var(--museflow-bg-secondary);
            border-radius: var(--radius-sm);
            font-size: 0.8125rem;
        }
        
        .widget-chart-mini {
            display: flex;
            align-items: flex-end;
            gap: 0.5rem;
            height: 80px;
            margin-bottom: 0.5rem;
        }
        
        .chart-bar {
            flex: 1;
            border-radius: 4px 4px 0 0;
            transition: height 0.3s ease;
        }
        
        /* Results Section */
        .results-section {
            padding: 1rem;
        }
        
        /* Canvas Preview */
        .canvas-preview {
            background: #FFFFFF;
            border: 2px dashed #E5E7EB;
            border-radius: 16px;
            min-height: 400px;
            padding: 2rem;
            position: relative;
        }
        
        .canvas-node {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 1.5rem;
            border-radius: 12px;
            margin-bottom: 1rem;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.2);
            animation: nodeAppear 0.5s ease;
        }
        
        @keyframes nodeAppear {
            from {
                opacity: 0;
                transform: scale(0.9) translateY(20px);
            }
            to {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }
        
        .canvas-node-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
        }
        
        .canvas-node-title {
            font-weight: 700;
            font-size: 1rem;
        }
        
        .canvas-node-icon {
            width: 32px;
            height: 32px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .canvas-node-content {
            font-size: 0.875rem;
            line-height: 1.6;
            opacity: 0.95;
        }
        
        /* Dashboard Preview */
        .dashboard-preview {
            display: grid;
            gap: 1rem;
        }
        
        .widget-preview {
            background: #FFFFFF;
            border: 1px solid #E5E7EB;
            border-radius: 12px;
            padding: 1.5rem;
            animation: widgetAppear 0.5s ease;
        }
        
        @keyframes widgetAppear {
            from {
                opacity: 0;
                transform: translateX(20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        .widget-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1rem;
        }
        
        .widget-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
        }
        
        .widget-title {
            font-weight: 700;
            font-size: 1rem;
            color: #111827;
        }
        
        .widget-content {
            font-size: 0.875rem;
            color: #6B7280;
            line-height: 1.6;
        }
        
        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 4rem 2rem;
            color: #9CA3AF;
        }
        
        .empty-state i {
            font-size: 4rem;
            margin-bottom: 1rem;
            opacity: 0.3;
        }
        
        .empty-state-title {
            font-size: 1.125rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }
        
        .empty-state-text {
            font-size: 0.875rem;
        }
        
        /* Scrollbar Styles */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #F3F4F6;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #D1D5DB;
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #9CA3AF;
        }
        
        /* Responsive */
        @media (max-width: 1200px) {
            .canvas-container {
                grid-template-columns: 250px 1fr 350px;
            }
        }
        
        /* Mobile Optimizations */
        @media (max-width: 768px) {
            body {
                padding-top: 120px; /* Navbar + Mobile Tabs */
            }
            
            .canvas-container {
                grid-template-columns: 1fr;
                height: calc(100vh - 120px);
                position: relative;
            }
            
            /* Mobile Tab Navigation */
            .mobile-tabs {
                display: flex;
                position: fixed;
                top: 64px;
                left: 0;
                right: 0;
                background: white;
                border-bottom: 2px solid var(--museflow-border-light);
                z-index: 100;
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }
            
            .mobile-tab {
                flex: 1;
                min-width: 80px;
                padding: 1rem 0.5rem;
                text-align: center;
                font-size: 0.75rem;
                font-weight: 600;
                color: var(--museflow-text-secondary);
                border-bottom: 3px solid transparent;
                transition: var(--transition-base);
                cursor: pointer;
                white-space: nowrap;
            }
            
            .mobile-tab i {
                display: block;
                font-size: 1.25rem;
                margin-bottom: 0.25rem;
            }
            
            .mobile-tab.active {
                color: var(--museflow-primary);
                border-bottom-color: var(--museflow-primary);
                background: var(--museflow-primary-light);
            }
            
            /* Mobile Columns */
            .left-column,
            .center-column,
            .right-column {
                display: none;
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: var(--museflow-bg-secondary);
                overflow-y: auto;
                -webkit-overflow-scrolling: touch;
            }
            
            .left-column.mobile-active,
            .center-column.mobile-active,
            .right-column.mobile-active {
                display: flex;
                animation: slideIn 0.3s ease;
            }
            
            @keyframes slideIn {
                from {
                    opacity: 0;
                    transform: translateX(20px);
                }
                to {
                    opacity: 1;
                    transform: translateX(0);
                }
            }
            
            /* Mobile Input Area */
            .input-area {
                position: fixed;
                bottom: 0;
                left: 0;
                right: 0;
                background: white;
                border-top: 1px solid var(--museflow-border-light);
                padding: 0.75rem;
                z-index: 99;
            }
            
            .message-input-container {
                gap: 0.5rem;
            }
            
            .message-input {
                font-size: 16px !important; /* Prevent iOS zoom */
                padding: 0.75rem !important;
            }
            
            .send-button {
                width: 44px;
                height: 44px;
            }
            
            /* Conversation Area Mobile */
            .conversation-area {
                padding-bottom: 80px; /* Space for fixed input */
            }
            
            /* Preview Tabs Mobile */
            .preview-tabs {
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }
            
            .preview-tab {
                font-size: 0.75rem;
                padding: 0.625rem 1rem;
            }
            
            /* History Items Touch-friendly */
            .history-item {
                padding: 1rem;
                margin-bottom: 0.625rem;
            }
            
            /* Quick Actions Mobile */
            .quick-actions-panel {
                padding: 0.75rem;
            }
            
            .quick-actions-grid {
                grid-template-columns: repeat(3, 1fr);
                gap: 0.5rem;
            }
            
            .quick-action-btn {
                padding: 0.625rem 0.375rem;
                font-size: 0.625rem;
                min-height: 64px;
            }
            
            .quick-action-btn i {
                font-size: 1.125rem;
            }
            
            .quick-action-btn span {
                font-size: 0.625rem;
                line-height: 1.2;
            }
            
            /* Live Stats Mobile */
            .stat-card-mini {
                padding: 0.75rem;
            }
            
            .stat-icon {
                width: 36px;
                height: 36px;
                font-size: 1rem;
            }
            
            .stat-value {
                font-size: 1rem;
            }
            
            /* Widgets Mobile */
            .widget-card {
                padding: 0.875rem;
            }
            
            .widget-value {
                font-size: 1.125rem;
            }
        }
        
        /* Tablet Landscape */
        @media (min-width: 769px) and (max-width: 1024px) {
            .canvas-container {
                grid-template-columns: 250px 1fr 350px;
            }
        }
        
        /* Hide mobile tabs on desktop */
        .mobile-tabs {
            display: none;
        }
    </style>
</head>
<body>
    <!-- Unified Navbar -->
    <nav class="unified-navbar">
        <div class="navbar-container">
            <!-- Logo -->
            <a href="/dashboard.html" class="museflow-logo">
                <div class="museflow-logo-icon">
                    <i class="fas fa-landmark"></i>
                </div>
                <span class="museflow-logo-text">MuseFlow</span>
            </a>
            
            <!-- Navigation Links -->
            <div class="navbar-links">
                <a href="/dashboard.html" class="navbar-link">
                    <i class="fas fa-th-large"></i>
                    <span>Dashboard</span>
                </a>
                <a href="/canvas-v4-hybrid.html" class="navbar-link active">
                    <i class="fas fa-project-diagram"></i>
                    <span>Canvas</span>
                </a>
                <a href="/projects.html" class="navbar-link">
                    <i class="fas fa-folder-open"></i>
                    <span>Projects</span>
                </a>
            </div>
            
            <!-- Right Actions -->
            <div class="navbar-actions">
                <button class="navbar-icon-btn" title="ÏïåÎ¶º">
                    <i class="fas fa-bell"></i>
                    <span class="notification-badge">3</span>
                </button>
                <button class="navbar-icon-btn" title="ÏÑ§Ï†ï">
                    <i class="fas fa-cog"></i>
                </button>
                <a href="/account.html" class="navbar-user">
                    <div class="user-avatar">
                        <i class="fas fa-user"></i>
                    </div>
                </a>
            </div>
        </div>
    </nav>
    
    <!-- Mobile Tab Navigation (visible only on mobile) -->
    <div class="mobile-tabs">
        <div class="mobile-tab active" data-mobile-tab="history">
            <i class="fas fa-history"></i>
            <span>History</span>
        </div>
        <div class="mobile-tab" data-mobile-tab="conversation">
            <i class="fas fa-comments"></i>
            <span>AI Chat</span>
        </div>
        <div class="mobile-tab" data-mobile-tab="preview">
            <i class="fas fa-eye"></i>
            <span>Preview</span>
        </div>
    </div>
    
    <div class="canvas-container">
        <!-- Left Column: History & Projects -->
        <div class="left-column">
            <div class="column-header">
                <h2 class="column-title">
                    <i class="fas fa-history"></i>
                    History & Projects
                </h2>
            </div>
            
            <!-- Quick Actions Panel -->
            <div class="quick-actions-panel">
                <div class="quick-actions-header">
                    <i class="fas fa-bolt"></i>
                    <span>Îπ†Î•∏ ÏûëÏóÖ</span>
                </div>
                <div class="quick-actions-grid">
                    <button class="quick-action-btn" data-action="exhibition-label">
                        <i class="fas fa-tag"></i>
                        <span>Ï†ÑÏãú ÎùºÎ≤®</span>
                    </button>
                    <button class="quick-action-btn" data-action="budget-approval">
                        <i class="fas fa-coins"></i>
                        <span>ÏòàÏÇ∞ ÏäπÏù∏</span>
                    </button>
                    <button class="quick-action-btn" data-action="artwork-selection">
                        <i class="fas fa-palette"></i>
                        <span>ÏÜåÏû•Ìíà ÏÑ†Ï†ï</span>
                    </button>
                    <button class="quick-action-btn" data-action="promotion-plan">
                        <i class="fas fa-bullhorn"></i>
                        <span>ÌôçÎ≥¥ Í≥ÑÌöç</span>
                    </button>
                    <button class="quick-action-btn" data-action="report-writing">
                        <i class="fas fa-file-alt"></i>
                        <span>Î≥¥Í≥†ÏÑú</span>
                    </button>
                    <button class="quick-action-btn" data-action="schedule-management">
                        <i class="fas fa-calendar-alt"></i>
                        <span>ÏùºÏ†ï Í¥ÄÎ¶¨</span>
                    </button>
                    <button class="quick-action-btn" data-action="education-program">
                        <i class="fas fa-graduation-cap"></i>
                        <span>ÍµêÏú° ÌîÑÎ°úÍ∑∏Îû®</span>
                    </button>
                    <button class="quick-action-btn" data-action="research">
                        <i class="fas fa-search"></i>
                        <span>ÏûêÎ£å Ï°∞ÏÇ¨</span>
                    </button>
                </div>
            </div>
            
            <div class="history-list" id="historyList">
                <div class="history-item active">
                    <div class="history-title">Ïù∏ÏÉÅÏ£ºÏùò ÌäπÎ≥ÑÏ†Ñ Í∏∞Ìöç</div>
                    <div class="history-meta">
                        <span>Ï†ÑÏãú Í∏∞Ìöç</span>
                        <span>Î∞©Í∏à Ï†Ñ</span>
                    </div>
                </div>
                
                <div class="history-item">
                    <div class="history-title">2024ÎÖÑ 1Î∂ÑÍ∏∞ ÏòàÏÇ∞ ÏäπÏù∏</div>
                    <div class="history-meta">
                        <span>ÏòàÏÇ∞ ÏäπÏù∏</span>
                        <span>2ÏãúÍ∞Ñ Ï†Ñ</span>
                    </div>
                </div>
                
                <div class="history-item">
                    <div class="history-title">Ïñ¥Î¶∞Ïù¥ ÍµêÏú° ÌîÑÎ°úÍ∑∏Îû®</div>
                    <div class="history-meta">
                        <span>ÍµêÏú° ÌîÑÎ°úÍ∑∏Îû®</span>
                        <span>Ïñ¥Ï†ú</span>
                    </div>
                </div>
                
                <div class="history-item">
                    <div class="history-title">ÌòÑÎåÄÎØ∏Ïà† ÏÜåÏû•Ìíà ÏÑ†Ï†ï</div>
                    <div class="history-meta">
                        <span>ÏÜåÏû•Ìíà ÏÑ†Ï†ï</span>
                        <span>3Ïùº Ï†Ñ</span>
                    </div>
                </div>
                
                <div class="history-item">
                    <div class="history-title">SNS ÌôçÎ≥¥ Ï∫†ÌéòÏù∏</div>
                    <div class="history-meta">
                        <span>ÌôçÎ≥¥ Í≥ÑÌöç</span>
                        <span>1Ï£ºÏùº Ï†Ñ</span>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Center Column: AI Conversation -->
        <div class="center-column">
            <div class="conversation-header">
                <h2 class="column-title">
                    <i class="fas fa-robot"></i>
                    AI Conversation
                </h2>
                <div class="ai-status-badge">
                    <i class="fas fa-circle"></i>
                    <span>AI Ready</span>
                </div>
            </div>
            
            <div class="conversation-area" id="conversationArea">
                <!-- Welcome Message -->
                <div class="message ai">
                    <div class="message-avatar">
                        <i class="fas fa-robot"></i>
                    </div>
                    <div class="message-content">
                        <div class="message-text">
                            ÏïàÎÖïÌïòÏÑ∏Ïöî! üëã MuseFlow AIÏûÖÎãàÎã§.<br>
                            Î¨¥ÏóáÏùÑ ÎèÑÏôÄÎìúÎ¶¥ÍπåÏöî? Ï†ÑÏãú Í∏∞Ìöç, ÏòàÏÇ∞ Í¥ÄÎ¶¨, ÍµêÏú° ÌîÑÎ°úÍ∑∏Îû® Îì± Î™®Îì† ÏóÖÎ¨¥Î•º ÏûêÎèôÌôîÌï¥ÎìúÎ¶ΩÎãàÎã§.
                        </div>
                        <div class="message-timestamp">Î∞©Í∏à Ï†Ñ</div>
                    </div>
                </div>
            </div>
            
            <div class="input-area">
                <div class="input-container">
                    <textarea 
                        id="messageInput" 
                        class="input-box" 
                        placeholder="AIÏóêÍ≤å Î™ÖÎ†πÌïòÏÑ∏Ïöî... (Ïòà: Ïù∏ÏÉÅÏ£ºÏùò ÌäπÎ≥ÑÏ†ÑÏùÑ 3000ÎßåÏõê ÏòàÏÇ∞ÏúºÎ°ú Í∏∞ÌöçÌï¥Ï§ò)"
                        rows="2"
                    ></textarea>
                    <button class="send-button" id="sendButton">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Right Column: Live Dashboard -->
        <div class="right-column">
            <div class="preview-tabs">
                <div class="preview-tab active" data-tab="overview">
                    <i class="fas fa-chart-line"></i> Ïã§ÏãúÍ∞Ñ ÌòÑÌô©
                </div>
                <div class="preview-tab" data-tab="widgets">
                    <i class="fas fa-th"></i> ÏúÑÏ†Ø
                </div>
                <div class="preview-tab" data-tab="results">
                    <i class="fas fa-file-alt"></i> ÏÉùÏÑ± Í≤∞Í≥º
                </div>
            </div>
            
            <div class="preview-content">
                <!-- Overview Panel - Ïã§ÏãúÍ∞Ñ ÌòÑÌô© -->
                <div class="preview-panel active" id="overviewPanel">
                    <div class="live-stats">
                        <div class="stat-card-mini">
                            <div class="stat-icon" style="background: var(--museflow-primary-light); color: var(--museflow-primary);">
                                <i class="fas fa-tasks"></i>
                            </div>
                            <div class="stat-info">
                                <div class="stat-label">Ïò§ÎäòÏùò ÏûëÏóÖ</div>
                                <div class="stat-value">5Í∞ú</div>
                            </div>
                        </div>
                        
                        <div class="stat-card-mini">
                            <div class="stat-icon" style="background: var(--status-success-bg); color: var(--status-success);">
                                <i class="fas fa-check-circle"></i>
                            </div>
                            <div class="stat-info">
                                <div class="stat-label">ÏôÑÎ£å</div>
                                <div class="stat-value">3Í∞ú</div>
                            </div>
                        </div>
                        
                        <div class="stat-card-mini">
                            <div class="stat-icon" style="background: var(--status-warning-bg); color: var(--status-warning);">
                                <i class="fas fa-clock"></i>
                            </div>
                            <div class="stat-info">
                                <div class="stat-label">ÏßÑÌñâ Ï§ë</div>
                                <div class="stat-value" id="activeTasksCount">0Í∞ú</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- AI ÏûëÏóÖ ÏßÑÌñâ ÏÉÅÌô© -->
                    <div class="active-tasks-section">
                        <div class="section-header">
                            <i class="fas fa-robot"></i>
                            <span>AI ÏûëÏóÖ ÏßÑÌñâ Ï§ë</span>
                        </div>
                        <div id="activeTasksList" class="active-tasks-list">
                            <div class="no-tasks">
                                <i class="fas fa-coffee"></i>
                                <p>ÌòÑÏû¨ ÏßÑÌñâ Ï§ëÏù∏ ÏûëÏóÖÏù¥ ÏóÜÏäµÎãàÎã§</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- ÏµúÍ∑º ÏÉùÏÑ± Ìï≠Î™© -->
                    <div class="recent-items-section">
                        <div class="section-header">
                            <i class="fas fa-history"></i>
                            <span>ÏµúÍ∑º ÏÉùÏÑ± Ìï≠Î™©</span>
                        </div>
                        <div id="recentItemsList" class="recent-items-list">
                            <div class="recent-item">
                                <div class="recent-icon">üìù</div>
                                <div class="recent-info">
                                    <div class="recent-title">Ï†ÑÏãú ÎùºÎ≤® Î¨∏ÏÑú</div>
                                    <div class="recent-time">5Î∂Ñ Ï†Ñ</div>
                                </div>
                            </div>
                            <div class="recent-item">
                                <div class="recent-icon">üí∞</div>
                                <div class="recent-info">
                                    <div class="recent-title">ÏòàÏÇ∞ ÏäπÏù∏ ÏöîÏ≤≠ÏÑú</div>
                                    <div class="recent-time">1ÏãúÍ∞Ñ Ï†Ñ</div>
                                </div>
                            </div>
                            <div class="recent-item">
                                <div class="recent-icon">üé®</div>
                                <div class="recent-info">
                                    <div class="recent-title">ÏÜåÏû•Ìíà ÏÑ†Ï†ï Î≥¥Í≥†ÏÑú</div>
                                    <div class="recent-time">Ïñ¥Ï†ú</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Widgets Panel - ÎåÄÏãúÎ≥¥Îìú ÏúÑÏ†Ø -->
                <div class="preview-panel" id="widgetsPanel">
                    <div class="widgets-grid" id="liveWidgets">
                        <!-- ÏúÑÏ†Ø 1: Ïù¥Î≤à Îã¨ ÏòàÏÇ∞ ÌòÑÌô© -->
                        <div class="widget-card">
                            <div class="widget-header-small">
                                <i class="fas fa-coins"></i>
                                <span>Ïù¥Î≤à Îã¨ ÏòàÏÇ∞ ÌòÑÌô©</span>
                            </div>
                            <div class="widget-value">‚Ç©85M / ‚Ç©100M</div>
                            <div class="widget-progress">
                                <div class="widget-progress-bar" style="width: 85%; background: var(--museflow-primary);"></div>
                            </div>
                            <div class="widget-footer">85% ÏÇ¨Ïö© Ï§ë</div>
                        </div>
                        
                        <!-- ÏúÑÏ†Ø 2: Ï†ÑÏãú ÏùºÏ†ï -->
                        <div class="widget-card">
                            <div class="widget-header-small">
                                <i class="fas fa-calendar"></i>
                                <span>Îã§Í∞ÄÏò§Îäî Ï†ÑÏãú</span>
                            </div>
                            <div class="widget-list">
                                <div class="widget-list-item">
                                    <span>üé® Ïù∏ÏÉÅÏ£ºÏùò ÌäπÎ≥ÑÏ†Ñ</span>
                                    <span>D-7</span>
                                </div>
                                <div class="widget-list-item">
                                    <span>üèõÔ∏è Í≥†Î†§Ï≤≠ÏûêÏ†Ñ</span>
                                    <span>D-14</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- ÏúÑÏ†Ø 3: ÏûëÏóÖ ÏßÑÌñâÎ•† -->
                        <div class="widget-card">
                            <div class="widget-header-small">
                                <i class="fas fa-tasks"></i>
                                <span>ÏûëÏóÖ ÏßÑÌñâÎ•†</span>
                            </div>
                            <div class="widget-chart-mini">
                                <div class="chart-bar" style="height: 60%; background: var(--status-success);"></div>
                                <div class="chart-bar" style="height: 80%; background: var(--museflow-primary);"></div>
                                <div class="chart-bar" style="height: 45%; background: var(--status-warning);"></div>
                                <div class="chart-bar" style="height: 90%; background: var(--status-success);"></div>
                            </div>
                            <div class="widget-footer">ÌèâÍ∑† 75% ÏôÑÎ£å</div>
                        </div>
                        
                        <!-- ÏúÑÏ†Ø 4: ÌåÄ ÌôúÎèô -->
                        <div class="widget-card">
                            <div class="widget-header-small">
                                <i class="fas fa-users"></i>
                                <span>ÌåÄ ÌôúÎèô</span>
                            </div>
                            <div class="widget-value">12Î™Ö ÌôúÎèô Ï§ë</div>
                            <div class="widget-footer">ÏßÄÎÇúÏ£ºÎ≥¥Îã§ +15%</div>
                        </div>
                    </div>
                </div>
                
                <!-- Results Panel - AI ÏÉùÏÑ± Í≤∞Í≥º -->
                <div class="preview-panel" id="resultsPanel">
                    <div id="canvasResults" class="results-section">
                        <div class="empty-state">
                            <i class="fas fa-magic"></i>
                            <div class="empty-state-title">AI ÏÉùÏÑ± Í≤∞Í≥º</div>
                            <div class="empty-state-text">AIÍ∞Ä ÏûëÏóÖÏùÑ ÏôÑÎ£åÌïòÎ©¥ Ïó¨Í∏∞Ïóê Í≤∞Í≥ºÍ∞Ä ÌëúÏãúÎê©ÎãàÎã§</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // State
        let eventSource = null;
        let sessionId = null;
        
        // Tab Switching - Updated for new panels
        document.querySelectorAll('.preview-tab').forEach(tab => {
            tab.addEventListener('click', function() {
                const tabName = this.dataset.tab;
                
                // Update active tab
                document.querySelectorAll('.preview-tab').forEach(t => t.classList.remove('active'));
                this.classList.add('active');
                
                // Update active panel
                document.querySelectorAll('.preview-panel').forEach(p => p.classList.remove('active'));
                
                // Show corresponding panel
                const panelMap = {
                    'overview': 'overviewPanel',
                    'widgets': 'widgetsPanel',
                    'results': 'resultsPanel'
                };
                
                const panelId = panelMap[tabName];
                if (panelId) {
                    document.getElementById(panelId).classList.add('active');
                }
            });
        });
        
        // History Item Click
        document.querySelectorAll('.history-item').forEach(item => {
            item.addEventListener('click', function() {
                document.querySelectorAll('.history-item').forEach(i => i.classList.remove('active'));
                this.classList.add('active');
            });
        });
        
        // Send Message
        document.getElementById('sendButton').addEventListener('click', sendMessage);
        document.getElementById('messageInput').addEventListener('keydown', function(e) {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                sendMessage();
            }
        });
        
        async function sendMessage() {
            const input = document.getElementById('messageInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            // Add user message to conversation
            addMessage('user', message);
            
            // Clear input
            input.value = '';
            
            // Disable send button
            document.getElementById('sendButton').disabled = true;
            
            // Send to AI
            await executeAICommand(message);
        }
        
        function addMessage(type, text) {
            const conversationArea = document.getElementById('conversationArea');
            const timestamp = new Date().toLocaleTimeString('ko-KR', { hour: '2-digit', minute: '2-digit' });
            
            const messageHtml = `
                <div class="message ${type}">
                    ${type === 'ai' ? `
                    <div class="message-avatar">
                        <i class="fas fa-robot"></i>
                    </div>
                    ` : ''}
                    <div class="message-content">
                        <div class="message-text">${text}</div>
                        <div class="message-timestamp">${timestamp}</div>
                    </div>
                    ${type === 'user' ? `
                    <div class="message-avatar">
                        <i class="fas fa-user"></i>
                    </div>
                    ` : ''}
                </div>
            `;
            
            conversationArea.insertAdjacentHTML('beforeend', messageHtml);
            conversationArea.scrollTop = conversationArea.scrollHeight;
        }
        
        async function executeAICommand(command) {
            try {
                // Add AI thinking message
                addMessage('ai', 'ü§î Î™ÖÎ†πÏùÑ Î∂ÑÏÑùÌïòÍ≥† ÏûàÏäµÎãàÎã§...');
                
                // Add to active tasks in overview panel
                addActiveTask(command.substring(0, 30) + '...');
                
                // Call API
                const response = await fetch('/api/orchestrator/execute', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        workflow_type: 'exhibition_planning',
                        user_input: command,
                        user_id: 'curator-demo',
                        autonomy_preference: 'balanced'
                    })
                });
                
                const data = await response.json();
                sessionId = data.session_id;
                
                // Connect to SSE
                connectToEventStream(sessionId);
                
            } catch (error) {
                console.error('AI Ïã§Ìñâ Ïò§Î•ò:', error);
                addMessage('ai', '‚ùå Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§. Îã§Ïãú ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî.');
                document.getElementById('sendButton').disabled = false;
                removeActiveTask();
            }
        }
        
        function connectToEventStream(sessionId) {
            if (eventSource) {
                eventSource.close();
            }
            
            eventSource = new EventSource(`/api/orchestrator/stream/${sessionId}`);
            
            eventSource.onmessage = function(event) {
                const data = JSON.parse(event.data);
                handleStreamEvent(data);
            };
            
            eventSource.onerror = function(error) {
                console.error('SSE Ïò§Î•ò:', error);
                eventSource.close();
                document.getElementById('sendButton').disabled = false;
            };
        }
        
        function handleStreamEvent(data) {
            const { type, payload } = data;
            
            switch (type) {
                case 'start':
                    addMessage('ai', `üöÄ ${payload.workflow_type} ÏõåÌÅ¨ÌîåÎ°úÏö∞Î•º ÏãúÏûëÌï©ÎãàÎã§...`);
                    break;
                
                case 'phase-start':
                    addPhaseProgress(payload.phase_name, 0);
                    break;
                
                case 'agent-action':
                    updatePhaseProgress(payload.action);
                    break;
                
                case 'phase-complete':
                    updatePhaseProgress('ÏôÑÎ£å', 100);
                    
                    // Add results to preview
                    if (payload.result?.canvas_nodes) {
                        addCanvasNodes(payload.result.canvas_nodes);
                    }
                    if (payload.result?.widgets) {
                        addDashboardWidgets(payload.result.widgets);
                    }
                    break;
                
                case 'complete':
                    addMessage('ai', '‚úÖ Î™®Îì† ÏûëÏóÖÏù¥ ÏôÑÎ£åÎêòÏóàÏäµÎãàÎã§! Ïö∞Ï∏° "ÏÉùÏÑ± Í≤∞Í≥º" ÌÉ≠ÏóêÏÑú ÌôïÏù∏ÌïòÏÑ∏Ïöî.');
                    document.getElementById('sendButton').disabled = false;
                    removeActiveTask();
                    eventSource.close();
                    break;
                
                case 'error':
                    addMessage('ai', `‚ùå Ïò§Î•ò: ${payload.message}`);
                    document.getElementById('sendButton').disabled = false;
                    eventSource.close();
                    break;
            }
        }
        
        function addPhaseProgress(phaseName, progress) {
            const conversationArea = document.getElementById('conversationArea');
            const timestamp = new Date().toLocaleTimeString('ko-KR', { hour: '2-digit', minute: '2-digit' });
            
            const progressHtml = `
                <div class="message ai">
                    <div class="message-avatar">
                        <i class="fas fa-robot"></i>
                    </div>
                    <div class="message-content">
                        <div class="message-text">
                            <strong>${phaseName}</strong> Îã®Í≥ÑÎ•º Ïã§ÌñâÌïòÍ≥† ÏûàÏäµÎãàÎã§...
                        </div>
                        <div class="phase-progress" data-phase="${phaseName}">
                            <div class="phase-title">ÏßÑÌñâ Ï§ë...</div>
                            <div class="phase-bar">
                                <div class="phase-bar-fill" style="width: ${progress}%"></div>
                            </div>
                        </div>
                        <div class="message-timestamp">${timestamp}</div>
                    </div>
                </div>
            `;
            
            conversationArea.insertAdjacentHTML('beforeend', progressHtml);
            conversationArea.scrollTop = conversationArea.scrollHeight;
        }
        
        function updatePhaseProgress(status, progress = null) {
            const phaseProgress = document.querySelector('.phase-progress:last-of-type');
            if (!phaseProgress) return;
            
            const title = phaseProgress.querySelector('.phase-title');
            const fill = phaseProgress.querySelector('.phase-bar-fill');
            
            title.textContent = status;
            if (progress !== null) {
                fill.style.width = progress + '%';
            }
        }
        
        function addCanvasNodes(nodes) {
            const resultsSection = document.getElementById('canvasResults');
            resultsSection.innerHTML = '';
            
            nodes.forEach(node => {
                const nodeHtml = `
                    <div class="canvas-node" style="background: white; border: 1px solid var(--museflow-border-light); border-radius: var(--radius-md); padding: 1rem; margin-bottom: 0.75rem;">
                        <div class="canvas-node-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                            <div class="canvas-node-title" style="font-weight: 700; color: var(--museflow-text-primary);">${node.title}</div>
                            <div class="canvas-node-icon">
                                <i class="fas fa-cube" style="color: var(--museflow-primary);"></i>
                            </div>
                        </div>
                        <div class="canvas-node-content" style="font-size: 0.875rem; color: var(--museflow-text-secondary);">
                            ${node.description || 'Canvas ÎÖ∏ÎìúÍ∞Ä ÏÉùÏÑ±ÎêòÏóàÏäµÎãàÎã§.'}
                        </div>
                    </div>
                `;
                resultsSection.insertAdjacentHTML('beforeend', nodeHtml);
            });
            
            // DashboardÏóê ÎÖ∏Îìú ÏÉùÏÑ± ÏïåÎ¶º
            notifyDashboardUpdate({
                type: 'canvas_nodes',
                title: `Canvas ÎÖ∏Îìú ${nodes.length}Í∞ú ÏÉùÏÑ±`,
                data: nodes
            });
            
            // Ïã§ÏãúÍ∞Ñ ÌòÑÌô© ÏóÖÎç∞Ïù¥Ìä∏
            updateOverviewStats();
        }
        
        function addDashboardWidgets(widgets) {
            const resultsSection = document.getElementById('canvasResults');
            
            widgets.forEach(widget => {
                const widgetHtml = `
                    <div class="widget-preview" style="background: white; border: 1px solid var(--museflow-border-light); border-radius: var(--radius-md); padding: 1rem; margin-bottom: 0.75rem;">
                        <div class="widget-header" style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                            <div class="widget-icon" style="color: var(--museflow-primary);">
                                <i class="fas fa-chart-bar"></i>
                            </div>
                            <div class="widget-title" style="font-weight: 700; color: var(--museflow-text-primary);">${widget.title}</div>
                        </div>
                        <div class="widget-content" style="font-size: 0.875rem; color: var(--museflow-text-secondary);">
                            ${widget.description || 'Dashboard ÏúÑÏ†ØÏù¥ ÏÉùÏÑ±ÎêòÏóàÏäµÎãàÎã§.'}
                        </div>
                    </div>
                `;
                resultsSection.insertAdjacentHTML('beforeend', widgetHtml);
            });
            
            // DashboardÏóê ÏúÑÏ†Ø ÏÉùÏÑ± ÏïåÎ¶º
            notifyDashboardUpdate({
                type: 'dashboard_widgets',
                title: `Dashboard ÏúÑÏ†Ø ${widgets.length}Í∞ú ÏÉùÏÑ±`,
                data: widgets
            });
            
            // Ïã§ÏãúÍ∞Ñ ÌòÑÌô© ÏóÖÎç∞Ïù¥Ìä∏
            updateOverviewStats();
            
            // Results ÌÉ≠ÏúºÎ°ú ÏûêÎèô Ï†ÑÌôò
            document.querySelectorAll('.preview-tab').forEach(t => t.classList.remove('active'));
            document.querySelector('[data-tab="results"]').classList.add('active');
            document.querySelectorAll('.preview-panel').forEach(p => p.classList.remove('active'));
            document.getElementById('resultsPanel').classList.add('active');
        }
        
        /**
         * Ïã§ÏãúÍ∞Ñ ÌòÑÌô© ÏóÖÎç∞Ïù¥Ìä∏
         */
        function updateOverviewStats() {
            // ÏßÑÌñâ Ï§ëÏù∏ ÏûëÏóÖ Ïπ¥Ïö¥Ìä∏ ÏóÖÎç∞Ïù¥Ìä∏
            const activeCount = document.getElementById('activeTasksCount');
            if (activeCount) {
                const currentValue = parseInt(activeCount.textContent) || 0;
                activeCount.textContent = `${currentValue + 1}Í∞ú`;
            }
        }
        
        /**
         * AI ÏûëÏóÖ ÏãúÏûë Ïãú Ïã§ÏãúÍ∞Ñ ÌòÑÌô© ÌëúÏãú
         */
        function addActiveTask(taskName) {
            const activeTasksList = document.getElementById('activeTasksList');
            const noTasks = activeTasksList.querySelector('.no-tasks');
            
            if (noTasks) {
                noTasks.remove();
            }
            
            const taskHtml = `
                <div class="active-task-item" id="task-${Date.now()}" style="padding: 0.75rem; background: var(--museflow-primary-light); border-radius: var(--radius-md); margin-bottom: 0.5rem; animation: slideIn 0.3s ease;">
                    <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                        <i class="fas fa-spinner fa-spin" style="color: var(--museflow-primary);"></i>
                        <span style="font-size: 0.875rem; font-weight: 600; color: var(--museflow-text-primary);">${taskName}</span>
                    </div>
                    <div class="task-progress" style="height: 4px; background: rgba(139, 92, 246, 0.2); border-radius: 2px; overflow: hidden;">
                        <div class="task-progress-bar" style="height: 100%; background: var(--museflow-primary); width: 0%; transition: width 1s ease;"></div>
                    </div>
                </div>
            `;
            
            activeTasksList.insertAdjacentHTML('beforeend', taskHtml);
            
            // Progress bar Ïï†ÎãàÎ©îÏù¥ÏÖò
            setTimeout(() => {
                const progressBar = activeTasksList.querySelector('.task-progress-bar:last-of-type');
                if (progressBar) {
                    progressBar.style.width = '60%';
                }
            }, 100);
        }
        
        /**
         * AI ÏûëÏóÖ ÏôÑÎ£å Ïãú Ïã§ÏãúÍ∞Ñ ÌòÑÌô©ÏóêÏÑú Ï†úÍ±∞
         */
        function removeActiveTask() {
            const activeTasksList = document.getElementById('activeTasksList');
            const tasks = activeTasksList.querySelectorAll('.active-task-item');
            
            if (tasks.length > 0) {
                tasks[tasks.length - 1].remove();
            }
            
            if (activeTasksList.children.length === 0) {
                activeTasksList.innerHTML = `
                    <div class="no-tasks">
                        <i class="fas fa-coffee"></i>
                        <p>ÌòÑÏû¨ ÏßÑÌñâ Ï§ëÏù∏ ÏûëÏóÖÏù¥ ÏóÜÏäµÎãàÎã§</p>
                    </div>
                `;
            }
        }
        
        // ==========================================
        // Dashboard ‚Üí Canvas Ïó∞Îèô: Task ÏûêÎèô Ïã§Ìñâ
        // ==========================================
        
        /**
         * ÌéòÏù¥ÏßÄ Î°úÎìú Ïãú DashboardÏóêÏÑú Ï†ÑÎã¨Îêú TaskÍ∞Ä ÏûàÎäîÏßÄ ÌôïÏù∏
         */
        function checkPendingDashboardTask() {
            const pendingTask = localStorage.getItem('pending_canvas_task');
            
            if (pendingTask) {
                try {
                    const taskData = JSON.parse(pendingTask);
                    console.log('[Canvas ‚Üê Dashboard] Received task:', taskData);
                    
                    // Task Îç∞Ïù¥ÌÑ∞ ÏÇ≠Ï†ú (Ìïú Î≤àÎßå Ïã§Ìñâ)
                    localStorage.removeItem('pending_canvas_task');
                    
                    // TaskÏóê ÎßûÎäî AI Î™ÖÎ†π ÏûêÎèô Ïã§Ìñâ
                    executeTaskFromDashboard(taskData);
                    
                } catch (error) {
                    console.error('[Canvas] Task parsing error:', error);
                }
            }
        }
        
        /**
         * Dashboard TaskÎ•º Canvas AI Î™ÖÎ†πÏúºÎ°ú Î≥ÄÌôò Î∞è Ïã§Ìñâ
         */
        function executeTaskFromDashboard(taskData) {
            const { title, type, project } = taskData;
            
            // Task Ïú†ÌòïÎ≥Ñ AI Î™ÖÎ†π ÏÉùÏÑ±
            let aiCommand = '';
            
            switch (type) {
                case 'document':
                    aiCommand = `${project || 'ÌîÑÎ°úÏ†ùÌä∏'}Ïùò "${title}" Î¨∏ÏÑúÎ•º ÏûëÏÑ±Ìï¥Ï£ºÏÑ∏Ïöî. Ï†ÑÏãú ÎùºÎ≤®, Î≥¥ÎèÑÏûêÎ£å, Í∏∞ÌöçÏïà Îì±ÏùÑ Ìè¨Ìï®Ìï¥Ï£ºÏÑ∏Ïöî.`;
                    break;
                case 'budget':
                    aiCommand = `${project || 'ÌîÑÎ°úÏ†ùÌä∏'}Ïùò ÏòàÏÇ∞ÏïàÏùÑ ÏûëÏÑ±Ìï¥Ï£ºÏÑ∏Ïöî. Ìï≠Î™©Î≥Ñ ÏòàÏÇ∞ Î∂ÑÏÑùÍ≥º Ï∞®Ìä∏Î•º Ìè¨Ìï®Ìï¥Ï£ºÏÑ∏Ïöî.`;
                    break;
                case 'promotion':
                    aiCommand = `${project || 'ÌîÑÎ°úÏ†ùÌä∏'}Ïùò ÌôçÎ≥¥ Í≥ÑÌöçÏùÑ ÏàòÎ¶ΩÌï¥Ï£ºÏÑ∏Ïöî. SNS ÏΩòÌÖêÏ∏†, Ïù¥Î©îÏùº Ï∫†ÌéòÏù∏, Î≥¥ÎèÑÏûêÎ£åÎ•º Ìè¨Ìï®Ìï¥Ï£ºÏÑ∏Ïöî.`;
                    break;
                case 'research':
                    aiCommand = `"${title}"Ïóê ÎåÄÌïú ÌïôÏà† ÏûêÎ£åÎ•º Ï°∞ÏÇ¨Ìï¥Ï£ºÏÑ∏Ïöî. ÏúÑÌÇ§ÌîºÎîîÏïÑ, MET Museum, Google ScholarÏóêÏÑú Í≤ÄÏÉâÌï¥Ï£ºÏÑ∏Ïöî.`;
                    break;
                default:
                    aiCommand = `${project || 'ÌîÑÎ°úÏ†ùÌä∏'}Ïùò "${title}" ÏûëÏóÖÏùÑ ÎèÑÏôÄÏ£ºÏÑ∏Ïöî.`;
            }
            
            // AI Î™ÖÎ†π ÏûêÎèô ÏûÖÎ†•
            const messageInput = document.getElementById('messageInput');
            messageInput.value = aiCommand;
            
            // ÌôòÏòÅ Î©îÏãúÏßÄ ÌëúÏãú
            addMessage('ai', `üëã ÏïàÎÖïÌïòÏÑ∏Ïöî! DashboardÏóêÏÑú "${title}" ÏûëÏóÖÏùÑ Ï†ÑÎã¨Î∞õÏïòÏäµÎãàÎã§. ÏûêÎèôÏúºÎ°ú Ïã§ÌñâÌïòÏãúÍ≤†ÏäµÎãàÍπå?`);
            
            // 2Ï¥à ÌõÑ ÏûêÎèô Ïã§Ìñâ (ÏÇ¨Ïö©ÏûêÍ∞Ä ÌôïÏù∏Ìï† ÏãúÍ∞Ñ Ï†úÍ≥µ)
            setTimeout(() => {
                sendMessage();
            }, 2000);
        }
        
        /**
         * Canvas ‚Üí Dashboard ÏúÑÏ†Ø ÏóÖÎç∞Ïù¥Ìä∏ ÏïåÎ¶º
         */
        function notifyDashboardUpdate(updateData) {
            // LocalStorageÎ•º ÌÜµÌïú Dashboard ÏóÖÎç∞Ïù¥Ìä∏ ÏïåÎ¶º
            const dashboardUpdates = JSON.parse(localStorage.getItem('dashboard_updates') || '[]');
            dashboardUpdates.push({
                timestamp: Date.now(),
                type: updateData.type,
                title: updateData.title,
                data: updateData.data
            });
            
            localStorage.setItem('dashboard_updates', JSON.stringify(dashboardUpdates));
            
            console.log('[Canvas ‚Üí Dashboard] Update sent:', updateData);
        }
        
        // ÌéòÏù¥ÏßÄ Î°úÎìú Ïãú Dashboard Task ÌôïÏù∏
        checkPendingDashboardTask();
        
        // ==========================================
        // Mobile Tab Navigation
        // ==========================================
        
        /**
         * Î™®Î∞îÏùº ÌÉ≠ Ï†ÑÌôò Ìï∏Îì§Îü¨
         */
        function initializeMobileTabs() {
            const mobileTabs = document.querySelectorAll('.mobile-tab');
            const leftColumn = document.querySelector('.left-column');
            const centerColumn = document.querySelector('.center-column');
            const rightColumn = document.querySelector('.right-column');
            
            // Í∏∞Î≥∏Í∞í: conversation (AI Chat) ÌÉ≠ ÌôúÏÑ±Ìôî
            if (window.innerWidth <= 768) {
                centerColumn.classList.add('mobile-active');
            }
            
            mobileTabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabName = this.getAttribute('data-mobile-tab');
                    
                    // Remove active class from all tabs
                    mobileTabs.forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Hide all columns
                    leftColumn.classList.remove('mobile-active');
                    centerColumn.classList.remove('mobile-active');
                    rightColumn.classList.remove('mobile-active');
                    
                    // Show selected column
                    switch(tabName) {
                        case 'history':
                            leftColumn.classList.add('mobile-active');
                            break;
                        case 'conversation':
                            centerColumn.classList.add('mobile-active');
                            break;
                        case 'preview':
                            rightColumn.classList.add('mobile-active');
                            break;
                    }
                });
            });
        }
        
        // ÌôîÎ©¥ ÌÅ¨Í∏∞ Î≥ÄÍ≤Ω Í∞êÏßÄ
        window.addEventListener('resize', function() {
            if (window.innerWidth > 768) {
                // Desktop: Î™®Îì† Ïª¨Îüº ÌëúÏãú
                document.querySelectorAll('.left-column, .center-column, .right-column').forEach(col => {
                    col.classList.remove('mobile-active');
                });
            } else {
                // Mobile: ÌôúÏÑ± ÌÉ≠Ïóê Îî∞Îùº Ïª¨Îüº ÌëúÏãú
                initializeMobileTabs();
            }
        });
        
        // ÌéòÏù¥ÏßÄ Î°úÎìú Ïãú Î™®Î∞îÏùº ÌÉ≠ Ï¥àÍ∏∞Ìôî
        if (window.innerWidth <= 768) {
            initializeMobileTabs();
        }
        
        // ==========================================
        // Quick Actions - Dashboard Î©îÎâ¥ ÌÜµÌï©
        // ==========================================
        
        /**
         * Quick Action Î™ÖÎ†πÏñ¥ Îß§Ìïë
         */
        const quickActionCommands = {
            'exhibition-label': {
                title: 'Ï†ÑÏãú ÎùºÎ≤® ÏûëÏÑ±',
                prompt: 'Ï†ÑÏãú ÎùºÎ≤®ÏùÑ ÏûëÏÑ±Ìï¥Ï£ºÏÑ∏Ïöî. ÏûëÌíàÎ™Ö, ÏûëÍ∞Ä, Ïó∞ÎèÑ, Ïû¨Î£å, ÌÅ¨Í∏∞, ÏÜåÏû• Ï†ïÎ≥¥Î•º Ìè¨Ìï®Ìïú Ï†ÑÎ¨∏Ï†ÅÏù∏ ÎùºÎ≤®ÏùÑ ÎßåÎì§Ïñ¥Ï£ºÏÑ∏Ïöî.',
                icon: 'üìù'
            },
            'budget-approval': {
                title: 'ÏòàÏÇ∞ ÏäπÏù∏ ÏöîÏ≤≠',
                prompt: 'ÏòàÏÇ∞ ÏäπÏù∏ ÏöîÏ≤≠ Î¨∏ÏÑúÎ•º ÏûëÏÑ±Ìï¥Ï£ºÏÑ∏Ïöî. Ìï≠Î™©Î≥Ñ ÏòàÏÇ∞, ÏÇ¨Ïö© Î™©Ï†Å, Í∏∞ÎåÄ Ìö®Í≥ºÎ•º Ìè¨Ìï®Ìï¥Ï£ºÏÑ∏Ïöî.',
                icon: 'üí∞'
            },
            'artwork-selection': {
                title: 'ÏÜåÏû•Ìíà ÏÑ†Ï†ï',
                prompt: 'Ï†ÑÏãú ÏÜåÏû•Ìíà ÏÑ†Ï†ï Í∏∞ÌöçÏïàÏùÑ ÏûëÏÑ±Ìï¥Ï£ºÏÑ∏Ïöî. ÏûëÌíà Î™©Î°ù, ÏÑ†Ï†ï Í∏∞Ï§Ä, Î∞∞Ïπò Í≥ÑÌöçÏùÑ Ìè¨Ìï®Ìï¥Ï£ºÏÑ∏Ïöî.',
                icon: 'üé®'
            },
            'promotion-plan': {
                title: 'ÌôçÎ≥¥ Í≥ÑÌöç ÏàòÎ¶Ω',
                prompt: 'ÌôçÎ≥¥ Í≥ÑÌöçÏùÑ ÏàòÎ¶ΩÌï¥Ï£ºÏÑ∏Ïöî. SNS ÏΩòÌÖêÏ∏†, Î≥¥ÎèÑÏûêÎ£å, Ïù¥Î©îÏùº Ï∫†ÌéòÏù∏, ÏùºÏ†ïÏùÑ Ìè¨Ìï®Ìï¥Ï£ºÏÑ∏Ïöî.',
                icon: 'üì¢'
            },
            'report-writing': {
                title: 'Î≥¥Í≥†ÏÑú ÏûëÏÑ±',
                prompt: 'ÏóÖÎ¨¥ Î≥¥Í≥†ÏÑúÎ•º ÏûëÏÑ±Ìï¥Ï£ºÏÑ∏Ïöî. ÌòÑÌô©, ÏÑ±Í≥º, Í≥ºÏ†ú, Ìñ•ÌõÑ Í≥ÑÌöçÏùÑ Ìè¨Ìï®Ìï¥Ï£ºÏÑ∏Ïöî.',
                icon: 'üìÑ'
            },
            'schedule-management': {
                title: 'Ï†ÑÏãú ÏùºÏ†ï Í¥ÄÎ¶¨',
                prompt: 'Ï†ÑÏãú ÏùºÏ†ï Í¥ÄÎ¶¨ Í≥ÑÌöçÏùÑ ÏûëÏÑ±Ìï¥Ï£ºÏÑ∏Ïöî. Ï§ÄÎπÑ Îã®Í≥ÑÎ≥Ñ Ï≤¥ÌÅ¨Î¶¨Ïä§Ìä∏ÏôÄ ÎßàÏùºÏä§ÌÜ§ÏùÑ Ìè¨Ìï®Ìï¥Ï£ºÏÑ∏Ïöî.',
                icon: 'üóìÔ∏è'
            },
            'education-program': {
                title: 'ÍµêÏú° ÌîÑÎ°úÍ∑∏Îû® Í∏∞Ìöç',
                prompt: 'ÍµêÏú° ÌîÑÎ°úÍ∑∏Îû®ÏùÑ Í∏∞ÌöçÌï¥Ï£ºÏÑ∏Ïöî. ÎåÄÏÉÅ, Ïª§Î¶¨ÌÅòÎüº, ÌôúÎèô ÎÇ¥Ïö©, ÌèâÍ∞Ä Î∞©Î≤ïÏùÑ Ìè¨Ìï®Ìï¥Ï£ºÏÑ∏Ïöî.',
                icon: 'üë•'
            },
            'research': {
                title: 'ÌïôÏà† ÏûêÎ£å Ï°∞ÏÇ¨',
                prompt: 'ÌïôÏà† ÏûêÎ£åÎ•º Ï°∞ÏÇ¨Ìï¥Ï£ºÏÑ∏Ïöî. Wikipedia, MET Museum, Google ScholarÏóêÏÑú Í¥ÄÎ†® Ï†ïÎ≥¥Î•º ÏàòÏßëÌï¥Ï£ºÏÑ∏Ïöî.',
                icon: 'üîç'
            }
        };
        
        /**
         * Quick Action Î≤ÑÌäº ÌÅ¥Î¶≠ Ìï∏Îì§Îü¨
         */
        document.querySelectorAll('.quick-action-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const action = this.getAttribute('data-action');
                const command = quickActionCommands[action];
                
                if (!command) return;
                
                // AI ÏûÖÎ†•Ï∞ΩÏóê ÌîÑÎ°¨ÌîÑÌä∏ ÏûêÎèô ÏûÖÎ†•
                const messageInput = document.getElementById('messageInput');
                messageInput.value = command.prompt;
                
                // ÌôòÏòÅ Î©îÏãúÏßÄ
                addMessage('ai', `${command.icon} "${command.title}" ÏûëÏóÖÏùÑ ÏãúÏûëÌï©ÎãàÎã§. ÏûêÎèôÏúºÎ°ú Ïã§ÌñâÌïòÏãúÍ≤†ÏäµÎãàÍπå?`);
                
                // Î™®Î∞îÏùº: Conversation ÌÉ≠ÏúºÎ°ú ÏûêÎèô Ï†ÑÌôò
                if (window.innerWidth <= 768) {
                    document.querySelectorAll('.mobile-tab').forEach(tab => {
                        tab.classList.remove('active');
                        if (tab.getAttribute('data-mobile-tab') === 'conversation') {
                            tab.classList.add('active');
                        }
                    });
                    
                    document.querySelector('.left-column').classList.remove('mobile-active');
                    document.querySelector('.center-column').classList.add('mobile-active');
                    document.querySelector('.right-column').classList.remove('mobile-active');
                }
                
                // ÏûÖÎ†•Ï∞Ω Ìè¨Ïª§Ïä§
                messageInput.focus();
                
                // 2Ï¥à ÌõÑ ÏûêÎèô Ï†ÑÏÜ°
                setTimeout(() => {
                    sendMessage();
                }, 2000);
            });
        });
    </script>
</body>
</html>
