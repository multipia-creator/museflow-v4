<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>Canvas â†’ Digital Twin ì‹¤ì‹œê°„ ì—°ë™ í…ŒìŠ¤íŠ¸</title>
    <style>
        body {
            font-family: 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #1e1e1e 0%, #2a2a2a 100%);
            color: #e5e5e5;
            padding: 40px;
            margin: 0;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: rgba(42, 42, 42, 0.8);
            backdrop-filter: blur(20px);
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
        }
        h1 {
            color: #10b981;
            margin-top: 0;
        }
        .step {
            background: rgba(30, 30, 30, 0.6);
            padding: 20px;
            margin: 15px 0;
            border-radius: 8px;
            border-left: 4px solid #10b981;
        }
        .step h3 {
            margin-top: 0;
            color: #10b981;
        }
        button {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 16px;
            font-weight: bold;
            border-radius: 8px;
            cursor: pointer;
            margin: 10px 5px;
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
            transition: all 0.3s ease;
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(16, 185, 129, 0.5);
        }
        .log {
            background: #0a0a0a;
            color: #10b981;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            margin-top: 10px;
            max-height: 300px;
            overflow-y: auto;
        }
        .success {
            color: #10b981;
        }
        .info {
            color: #3b82f6;
        }
        .warning {
            color: #f59e0b;
        }
        code {
            background: rgba(16, 185, 129, 0.1);
            padding: 2px 6px;
            border-radius: 4px;
            color: #10b981;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”— Canvas V4 â†” Digital Twin ì‹¤ì‹œê°„ ì—°ë™ í…ŒìŠ¤íŠ¸</h1>
        
        <div class="step">
            <h3>ğŸ“¤ Step 1: Canvas V4 ë°ì´í„° ìƒì„± ë° ì €ì¥</h3>
            <p>Canvas V4ì—ì„œ "ê³µê°„ ìµœì í™”" ë²„íŠ¼ í´ë¦­ ì‹œë®¬ë ˆì´ì…˜</p>
            <button onclick="sendData()">ê³µê°„ ìµœì í™” í´ë¦­ ì‹œë®¬ë ˆì´ì…˜</button>
            <div id="send-log" class="log" style="display:none;"></div>
        </div>

        <div class="step">
            <h3>ğŸ“¥ Step 2: Digital Twin ë°ì´í„° ë¡œë“œ</h3>
            <p>Digital Twin í˜ì´ì§€ì—ì„œ localStorage ë°ì´í„° ì½ê¸°</p>
            <button onclick="openDigitalTwin()">Digital Twin ì—´ê¸°</button>
            <button onclick="checkStorage()">localStorage í™•ì¸</button>
            <div id="receive-log" class="log" style="display:none;"></div>
        </div>

        <div class="step">
            <h3>âœ… Step 3: ì „ì²´ í”Œë¡œìš° í…ŒìŠ¤íŠ¸</h3>
            <p>Canvas â†’ localStorage â†’ Digital Twin ì™„ì „í•œ ë°ì´í„° íë¦„ í…ŒìŠ¤íŠ¸</p>
            <button onclick="fullTest()">ì „ì²´ í…ŒìŠ¤íŠ¸ ì‹¤í–‰</button>
            <div id="full-log" class="log" style="display:none;"></div>
        </div>

        <div class="step">
            <h3>ğŸŒ í”„ë¡œë•ì…˜ URL</h3>
            <p>
                <strong>Canvas V4:</strong><br>
                <a href="https://b9760cf6.museflow.pages.dev/canvas-v4-hybrid" target="_blank" style="color: #10b981;">
                    https://b9760cf6.museflow.pages.dev/canvas-v4-hybrid
                </a>
            </p>
            <p>
                <strong>Digital Twin:</strong><br>
                <a href="https://b9760cf6.museflow.pages.dev/digital-twin" target="_blank" style="color: #10b981;">
                    https://b9760cf6.museflow.pages.dev/digital-twin
                </a>
            </p>
        </div>
    </div>

    <script>
        function log(elementId, message, type = 'info') {
            const logEl = document.getElementById(elementId);
            logEl.style.display = 'block';
            const timestamp = new Date().toLocaleTimeString('ko-KR');
            const icon = type === 'success' ? 'âœ…' : type === 'warning' ? 'âš ï¸' : 'â„¹ï¸';
            logEl.innerHTML += `<div class="${type}">[${timestamp}] ${icon} ${message}</div>`;
            logEl.scrollTop = logEl.scrollHeight;
        }

        function sendData() {
            const logEl = document.getElementById('send-log');
            logEl.innerHTML = '';
            
            // ì‹¤ì œ Canvas V4ì™€ ë™ì¼í•œ ë°ì´í„° êµ¬ì¡°
            const canvasData = {
                widgets: 103,
                timestamp: new Date().toISOString(),
                source: 'canvas-v4-hybrid'
            };
            
            log('send-log', 'Canvas V4 ë°ì´í„° ìƒì„±...', 'info');
            log('send-log', `ìœ„ì ¯ ìˆ˜: ${canvasData.widgets}ê°œ`, 'info');
            log('send-log', `íƒ€ì„ìŠ¤íƒ¬í”„: ${canvasData.timestamp}`, 'info');
            
            // localStorageì— ì €ì¥
            localStorage.setItem('museflow_canvas_data', JSON.stringify(canvasData));
            log('send-log', 'localStorage ì €ì¥ ì™„ë£Œ!', 'success');
            log('send-log', `í‚¤: museflow_canvas_data`, 'success');
            
            setTimeout(() => {
                log('send-log', 'âœ… Canvas V4 ë°ì´í„° ì „ì†¡ ì™„ë£Œ!', 'success');
            }, 500);
        }

        function checkStorage() {
            const logEl = document.getElementById('receive-log');
            logEl.innerHTML = '';
            
            log('receive-log', 'localStorage í™•ì¸ ì¤‘...', 'info');
            
            const data = localStorage.getItem('museflow_canvas_data');
            if (data) {
                const parsed = JSON.parse(data);
                log('receive-log', 'âœ… ë°ì´í„° ë°œê²¬!', 'success');
                log('receive-log', `ìœ„ì ¯: ${parsed.widgets}ê°œ`, 'success');
                log('receive-log', `íƒ€ì„ìŠ¤íƒ¬í”„: ${parsed.timestamp}`, 'info');
                log('receive-log', `ì†ŒìŠ¤: ${parsed.source}`, 'info');
            } else {
                log('receive-log', 'âš ï¸ localStorageì— ë°ì´í„° ì—†ìŒ', 'warning');
                log('receive-log', 'ë¨¼ì € "ê³µê°„ ìµœì í™” í´ë¦­ ì‹œë®¬ë ˆì´ì…˜" ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”', 'warning');
            }
        }

        function openDigitalTwin() {
            const data = localStorage.getItem('museflow_canvas_data');
            if (!data) {
                alert('ë¨¼ì € "ê³µê°„ ìµœì í™” í´ë¦­ ì‹œë®¬ë ˆì´ì…˜" ë²„íŠ¼ì„ ëˆŒëŸ¬ ë°ì´í„°ë¥¼ ìƒì„±í•´ì£¼ì„¸ìš”!');
                return;
            }
            
            // Digital Twin í˜ì´ì§€ ì—´ê¸°
            window.open('https://b9760cf6.museflow.pages.dev/digital-twin', '_blank');
            
            log('receive-log', 'Digital Twin í˜ì´ì§€ ì—´ë¦¼', 'success');
            log('receive-log', 'ìƒˆ íƒ­ì—ì„œ ì½˜ì†”ì„ í™•ì¸í•˜ì„¸ìš”!', 'info');
            log('receive-log', 'ì˜ˆìƒ ë©”ì‹œì§€: "ğŸ“Š Canvas V4 ë°ì´í„° ë¡œë“œ"', 'info');
        }

        function fullTest() {
            const logEl = document.getElementById('full-log');
            logEl.innerHTML = '';
            
            log('full-log', '=== ì „ì²´ í”Œë¡œìš° í…ŒìŠ¤íŠ¸ ì‹œì‘ ===', 'info');
            
            // Step 1
            log('full-log', 'Step 1: Canvas V4 ë°ì´í„° ìƒì„±', 'info');
            const canvasData = {
                widgets: 103,
                timestamp: new Date().toISOString(),
                source: 'canvas-v4-hybrid'
            };
            localStorage.setItem('museflow_canvas_data', JSON.stringify(canvasData));
            log('full-log', 'âœ… localStorage ì €ì¥ ì™„ë£Œ', 'success');
            
            setTimeout(() => {
                // Step 2
                log('full-log', 'Step 2: Digital Twin ë°ì´í„° ë¡œë“œ ì‹œë®¬ë ˆì´ì…˜', 'info');
                const loaded = localStorage.getItem('museflow_canvas_data');
                if (loaded) {
                    const parsed = JSON.parse(loaded);
                    log('full-log', `âœ… ë°ì´í„° ë¡œë“œ ì„±ê³µ: ${parsed.widgets}ê°œ ìœ„ì ¯`, 'success');
                    
                    setTimeout(() => {
                        // Step 3
                        log('full-log', 'Step 3: ë°ì´í„° ê²€ì¦', 'info');
                        const valid = parsed.widgets === 103 && 
                                     parsed.source === 'canvas-v4-hybrid' &&
                                     !!parsed.timestamp;
                        
                        if (valid) {
                            log('full-log', 'âœ… ëª¨ë“  í•„ë“œ ê²€ì¦ í†µê³¼', 'success');
                            
                            setTimeout(() => {
                                // Step 4
                                log('full-log', 'Step 4: localStorage ì •ë¦¬', 'info');
                                localStorage.removeItem('museflow_canvas_data');
                                log('full-log', 'âœ… ë°ì´í„° ì‚­ì œ ì™„ë£Œ (ì¤‘ë³µ ë°©ì§€)', 'success');
                                
                                setTimeout(() => {
                                    log('full-log', '=== âœ… ì „ì²´ í…ŒìŠ¤íŠ¸ ì™„ë£Œ! ===', 'success');
                                    log('full-log', 'í”„ë¡œë•ì…˜ í™˜ê²½ì—ì„œ ì‹¤ì œ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•˜ì„¸ìš”:', 'info');
                                    log('full-log', '1. Canvas V4 í˜ì´ì§€ ì ‘ì†', 'info');
                                    log('full-log', '2. "ê³µê°„ ìµœì í™”" ë²„íŠ¼ í´ë¦­', 'info');
                                    log('full-log', '3. Digital Twin ìë™ ì˜¤í”ˆ ë° ë°ì´í„° ë¡œë“œ í™•ì¸', 'info');
                                }, 500);
                            }, 500);
                        } else {
                            log('full-log', 'âŒ ë°ì´í„° ê²€ì¦ ì‹¤íŒ¨', 'warning');
                        }
                    }, 500);
                } else {
                    log('full-log', 'âŒ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨', 'warning');
                }
            }, 500);
        }
    </script>
</body>
</html>
